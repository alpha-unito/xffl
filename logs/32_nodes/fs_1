2, 1, 2
[38;20m2025-03-26 01:16:24,172 | xffl.cli.simulate |     INFO | *** Cross-Facility Federated Learning (xFFL) - Simulation ***[0m
[38;5;226m2025-03-26 01:16:24,172 |   xffl.cli.utils |  WARNING | CLI argument "help" has got default value "False"[0m
[38;5;226m2025-03-26 01:16:24,172 |   xffl.cli.utils |  WARNING | CLI argument "workdir" has got default value "/leonardo_scratch/fast/uToID_bench/xffl"[0m
[38;5;226m2025-03-26 01:16:24,172 |   xffl.cli.utils |  WARNING | CLI argument "image" has got default value "None"[0m
[38;5;39m2025-03-26 01:16:24,174 | xffl.cli.simulate |    DEBUG | Using virtual environment: /leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate[0m
[38;5;39m2025-03-26 01:16:24,174 | xffl.cli.simulate |    DEBUG | New local simulation xFFL environment variables: {'XFFL_WORLD_SIZE': '112', 'XFFL_NUM_NODES': '28', 'MASTER_ADDR': 'lrdn0001', 'VENV': '/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate', 'XFFL_FACILITY': 'leonardo', 'XFFL_SIMULATION': 'true'}[0m
[38;5;39m2025-03-26 01:16:24,174 | xffl.cli.simulate |    DEBUG | Updated xFFL environment: {'XFFL_WORLD_SIZE': '112', 'XFFL_NUM_NODES': '28', 'MASTER_ADDR': 'lrdn0001', 'VENV': '/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate', 'XFFL_FACILITY': 'leonardo', 'XFFL_SIMULATION': 'true'}[0m
[38;20m2025-03-26 01:16:24,174 | xffl.cli.simulate |     INFO | Running local simulation...[0m
[38;5;39m2025-03-26 01:16:24,174 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn0001: ssh -oStrictHostKeyChecking=no lrdn0001 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=0 XFFL_FEDERATED_RANK=0 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:24,174 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn0010: ssh -oStrictHostKeyChecking=no lrdn0010 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=1 XFFL_FEDERATED_RANK=0 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:24,175 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn0046: ssh -oStrictHostKeyChecking=no lrdn0046 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=2 XFFL_FEDERATED_RANK=0 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:24,175 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn0047: ssh -oStrictHostKeyChecking=no lrdn0047 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=3 XFFL_FEDERATED_RANK=0 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:24,175 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn0182: ssh -oStrictHostKeyChecking=no lrdn0182 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=4 XFFL_FEDERATED_RANK=1 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:24,176 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn0189: ssh -oStrictHostKeyChecking=no lrdn0189 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=5 XFFL_FEDERATED_RANK=1 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:24,176 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn0195: ssh -oStrictHostKeyChecking=no lrdn0195 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=6 XFFL_FEDERATED_RANK=1 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:24,176 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn0211: ssh -oStrictHostKeyChecking=no lrdn0211 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=7 XFFL_FEDERATED_RANK=1 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:24,176 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn0361: ssh -oStrictHostKeyChecking=no lrdn0361 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=8 XFFL_FEDERATED_RANK=2 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:24,176 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn0370: ssh -oStrictHostKeyChecking=no lrdn0370 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=9 XFFL_FEDERATED_RANK=2 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:24,177 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn0375: ssh -oStrictHostKeyChecking=no lrdn0375 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=10 XFFL_FEDERATED_RANK=2 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:24,177 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn0391: ssh -oStrictHostKeyChecking=no lrdn0391 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=11 XFFL_FEDERATED_RANK=2 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:24,177 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn0542: ssh -oStrictHostKeyChecking=no lrdn0542 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=12 XFFL_FEDERATED_RANK=3 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:24,177 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn0549: ssh -oStrictHostKeyChecking=no lrdn0549 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=13 XFFL_FEDERATED_RANK=3 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:24,178 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn0555: ssh -oStrictHostKeyChecking=no lrdn0555 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=14 XFFL_FEDERATED_RANK=3 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:24,178 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn0571: ssh -oStrictHostKeyChecking=no lrdn0571 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=15 XFFL_FEDERATED_RANK=3 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:24,179 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn0722: ssh -oStrictHostKeyChecking=no lrdn0722 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=16 XFFL_FEDERATED_RANK=4 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:24,179 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn0730: ssh -oStrictHostKeyChecking=no lrdn0730 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=17 XFFL_FEDERATED_RANK=4 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:24,179 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn0735: ssh -oStrictHostKeyChecking=no lrdn0735 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=18 XFFL_FEDERATED_RANK=4 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:24,180 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn0751: ssh -oStrictHostKeyChecking=no lrdn0751 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=19 XFFL_FEDERATED_RANK=4 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:24,180 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn0901: ssh -oStrictHostKeyChecking=no lrdn0901 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=20 XFFL_FEDERATED_RANK=5 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:24,180 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn0911: ssh -oStrictHostKeyChecking=no lrdn0911 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=21 XFFL_FEDERATED_RANK=5 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:24,181 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn0916: ssh -oStrictHostKeyChecking=no lrdn0916 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=22 XFFL_FEDERATED_RANK=5 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:24,181 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn0932: ssh -oStrictHostKeyChecking=no lrdn0932 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=23 XFFL_FEDERATED_RANK=5 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:24,181 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn1084: ssh -oStrictHostKeyChecking=no lrdn1084 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=24 XFFL_FEDERATED_RANK=6 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:24,181 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn1090: ssh -oStrictHostKeyChecking=no lrdn1090 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=25 XFFL_FEDERATED_RANK=6 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:24,181 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn1103: ssh -oStrictHostKeyChecking=no lrdn1103 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=26 XFFL_FEDERATED_RANK=6 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:24,182 | xffl.cli.simulate |    DEBUG | Simulation command on lrdn1111: ssh -oStrictHostKeyChecking=no lrdn1111 " XFFL_WORLD_SIZE=112 XFFL_NUM_NODES=28 MASTER_ADDR=lrdn0001 VENV=/leonardo_scratch/fast/uToID_bench/xffl/.venv/bin/activate XFFL_FACILITY=leonardo XFFL_SIMULATION=true XFFL_FEDERATED_LOCAL_WORLD_SIZE=4,4,4,4,4,4,4  XFFL_NODEID=27 XFFL_FEDERATED_RANK=6 /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/workflow/scripts/facilitator.sh /leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py -mn llama3.1-8b -mp /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b -dn clean_mc4_it -dp /leonardo_scratch/fast/uToID_bench/xffl/datasets/clean_mc4_it --seed 42 -fspan 1 -hsdp 4 --subsampling 28672 -dbg -t 8 -wb -name llama3.1-32_nodes-HSDP_4-FS -mode offline "[0m
[38;5;39m2025-03-26 01:16:33,459 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:33,459 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:33,459 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:33,459 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:33,484 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:33,484 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:33,484 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:33,484 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:33,522 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:33,522 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:33,522 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:33,522 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:33,783 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:33,783 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:33,783 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:33,783 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:33,751 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:33,751 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:33,751 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:33,751 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:33,874 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:33,874 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:33,874 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:33,874 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:33,827 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:33,827 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:33,827 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:33,827 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:34,071 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:34,071 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:34,071 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:34,071 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:34,544 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:34,544 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:34,544 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:34,544 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:34,706 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:34,706 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:34,706 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:34,706 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:34,753 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:34,753 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:34,753 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:34,753 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,402 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,402 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,402 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,402 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,427 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,427 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,427 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,427 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,530 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,530 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,530 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,530 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,495 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,495 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,495 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,495 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,573 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,573 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,573 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,573 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,534 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,534 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,534 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,534 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,762 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,762 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,762 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:35,762 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,277 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,277 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,277 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,277 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,459 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,459 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,459 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,459 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,623 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,623 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,623 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,623 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,683 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,683 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,683 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,683 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,621 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,621 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,621 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,621 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,688 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,688 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,688 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,688 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,866 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,866 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,866 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,866 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,803 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,803 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,803 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,803 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,803 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,803 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,803 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,803 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,867 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,867 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,867 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:37,867 | xffl.learning.utils |    DEBUG | Setting RNGs seed to 42[0m
[38;5;39m2025-03-26 01:16:40,426 | xffl.learning.distributed |    DEBUG | [Rank 0]: distributed setup: DistributedState(rank=0, world_size=112, group_local_rank=0, group_local_size=4, group_rank=0, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=0, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=0, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fcb93eaecf0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fcb93eaef30>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fcb93eaee30>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,426 |         __main__ |    DEBUG | Randez-vous time: 3.14 seconds[0m
[38;5;39m2025-03-26 01:16:40,426 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,428 | xffl.learning.distributed |    DEBUG | [Rank 1]: distributed setup: DistributedState(rank=1, world_size=112, group_local_rank=1, group_local_size=4, group_rank=0, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=1, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=0, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fce9321abb0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fce9321acf0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fce9321aaf0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,431 | xffl.learning.distributed |    DEBUG | [Rank 2]: distributed setup: DistributedState(rank=2, world_size=112, group_local_rank=2, group_local_size=4, group_rank=0, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=2, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=0, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f5d6961b630>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f5d6961b870>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f5d6961b770>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,432 | xffl.learning.distributed |    DEBUG | [Rank 8]: distributed setup: DistributedState(rank=8, world_size=112, group_local_rank=0, group_local_size=4, group_rank=2, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=8, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=0, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fbf052ef0f0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fbf052ef330>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fbf052ef230>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,432 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,432 | xffl.learning.distributed |    DEBUG | [Rank 9]: distributed setup: DistributedState(rank=9, world_size=112, group_local_rank=1, group_local_size=4, group_rank=2, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=9, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=0, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f96496cec70>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f96496ceeb0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f96496cedb0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,433 | xffl.learning.distributed |    DEBUG | [Rank 96]: distributed setup: DistributedState(rank=96, world_size=112, group_local_rank=0, group_local_size=4, group_rank=24, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=0, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=6, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f69292976b0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f69292977f0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f69292978b0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,433 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,433 | xffl.learning.distributed |    DEBUG | [Rank 10]: distributed setup: DistributedState(rank=10, world_size=112, group_local_rank=2, group_local_size=4, group_rank=2, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=10, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=0, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f6bdbdbf5f0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f6bdbdbf830>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f6bdbdbf730>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,433 | xffl.learning.distributed |    DEBUG | [Rank 3]: distributed setup: DistributedState(rank=3, world_size=112, group_local_rank=3, group_local_size=4, group_rank=0, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=3, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=0, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f0cdec7fb70>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f0cdec7fdb0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f0cdec7fcb0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,434 | xffl.learning.distributed |    DEBUG | [Rank 4]: distributed setup: DistributedState(rank=4, world_size=112, group_local_rank=0, group_local_size=4, group_rank=1, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=4, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=0, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f89a9717030>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f89a9717270>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f89a9717170>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,434 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,434 | xffl.learning.distributed |    DEBUG | [Rank 97]: distributed setup: DistributedState(rank=97, world_size=112, group_local_rank=1, group_local_size=4, group_rank=24, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=1, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=6, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fb5905371b0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fb5905372f0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fb5905373b0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,434 | xffl.learning.distributed |    DEBUG | [Rank 6]: distributed setup: DistributedState(rank=6, world_size=112, group_local_rank=2, group_local_size=4, group_rank=1, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=6, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=0, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f5a99eb39f0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f5a99eb3c30>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f5a99eb3b30>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,434 | xffl.learning.distributed |    DEBUG | [Rank 11]: distributed setup: DistributedState(rank=11, world_size=112, group_local_rank=3, group_local_size=4, group_rank=2, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=11, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=0, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f2d4392bab0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f2d4392bcb0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f2d4392bbf0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,435 | xffl.learning.distributed |    DEBUG | [Rank 5]: distributed setup: DistributedState(rank=5, world_size=112, group_local_rank=1, group_local_size=4, group_rank=1, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=5, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=0, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f6811e3a7b0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f6811e3a9b0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f6811e3a8f0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,435 | xffl.learning.distributed |    DEBUG | [Rank 98]: distributed setup: DistributedState(rank=98, world_size=112, group_local_rank=2, group_local_size=4, group_rank=24, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=2, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=6, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fa92befb670>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fa92befb7b0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fa92befb770>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,372 | xffl.learning.distributed |    DEBUG | [Rank 80]: distributed setup: DistributedState(rank=80, world_size=112, group_local_rank=0, group_local_size=4, group_rank=20, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=0, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=5, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f333f952ef0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f333f953130>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f333f953030>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,372 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,435 | xffl.learning.distributed |    DEBUG | [Rank 48]: distributed setup: DistributedState(rank=48, world_size=112, group_local_rank=0, group_local_size=4, group_rank=12, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=0, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=3, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f92af373ab0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f92af373bb0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f92af373b30>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,436 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,435 | xffl.learning.distributed |    DEBUG | [Rank 14]: distributed setup: DistributedState(rank=14, world_size=112, group_local_rank=2, group_local_size=4, group_rank=3, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=14, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=0, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fab3118f5f0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fab3118f830>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fab3118f730>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,435 | xffl.learning.distributed |    DEBUG | [Rank 12]: distributed setup: DistributedState(rank=12, world_size=112, group_local_rank=0, group_local_size=4, group_rank=3, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=12, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=0, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fe8a208b9f0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fe8a208bc30>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fe8a208bb30>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,435 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,435 | xffl.learning.distributed |    DEBUG | [Rank 16]: distributed setup: DistributedState(rank=16, world_size=112, group_local_rank=0, group_local_size=4, group_rank=4, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=0, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=1, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fb4b94db1f0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fb4b94db430>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fb4b94db330>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,436 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,436 | xffl.learning.distributed |    DEBUG | [Rank 13]: distributed setup: DistributedState(rank=13, world_size=112, group_local_rank=1, group_local_size=4, group_rank=3, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=13, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=0, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fa57c572eb0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fa57c573030>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fa57c5731b0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,436 | xffl.learning.distributed |    DEBUG | [Rank 7]: distributed setup: DistributedState(rank=7, world_size=112, group_local_rank=3, group_local_size=4, group_rank=1, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=7, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=0, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fb27cf3b870>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fb27cf3bab0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fb27cf3b9b0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,436 | xffl.learning.distributed |    DEBUG | [Rank 18]: distributed setup: DistributedState(rank=18, world_size=112, group_local_rank=2, group_local_size=4, group_rank=4, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=2, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=1, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fead64ca970>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fead64cabb0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fead64caab0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,373 | xffl.learning.distributed |    DEBUG | [Rank 81]: distributed setup: DistributedState(rank=81, world_size=112, group_local_rank=1, group_local_size=4, group_rank=20, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=1, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=5, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fe62cc26df0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fe62cc27030>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fe62cc26f30>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,436 | xffl.learning.distributed |    DEBUG | [Rank 17]: distributed setup: DistributedState(rank=17, world_size=112, group_local_rank=1, group_local_size=4, group_rank=4, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=1, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=1, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f4cf99cf230>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f4cf99cf470>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f4cf99cf370>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,436 | xffl.learning.distributed |    DEBUG | [Rank 99]: distributed setup: DistributedState(rank=99, world_size=112, group_local_rank=3, group_local_size=4, group_rank=24, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=3, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=6, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f1724727330>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f17247272b0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f17247274f0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,437 | xffl.learning.distributed |    DEBUG | [Rank 19]: distributed setup: DistributedState(rank=19, world_size=112, group_local_rank=3, group_local_size=4, group_rank=4, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=3, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=1, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f5414693530>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f5414693770>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f5414693670>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,437 | xffl.learning.distributed |    DEBUG | [Rank 50]: distributed setup: DistributedState(rank=50, world_size=112, group_local_rank=2, group_local_size=4, group_rank=12, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=2, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=3, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f7453eb7af0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f7453eb7d30>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f7453eb7c30>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,437 | xffl.learning.distributed |    DEBUG | [Rank 32]: distributed setup: DistributedState(rank=32, world_size=112, group_local_rank=0, group_local_size=4, group_rank=8, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=0, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=2, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f7147d9b7b0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f7147d9b9f0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f7147d9b8f0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,437 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,374 | xffl.learning.distributed |    DEBUG | [Rank 85]: distributed setup: DistributedState(rank=85, world_size=112, group_local_rank=1, group_local_size=4, group_rank=21, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=5, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=5, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fab2eb3ff30>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fab2eb64170>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fab2eb641b0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,437 | xffl.learning.distributed |    DEBUG | [Rank 52]: distributed setup: DistributedState(rank=52, world_size=112, group_local_rank=0, group_local_size=4, group_rank=13, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=4, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=3, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f3154fbf8f0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f3154fbfa70>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f3154fbfa30>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,437 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,374 | xffl.learning.distributed |    DEBUG | [Rank 83]: distributed setup: DistributedState(rank=83, world_size=112, group_local_rank=3, group_local_size=4, group_rank=20, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=3, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=5, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fadddac3370>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fadddac35b0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fadddac34b0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,437 | xffl.learning.distributed |    DEBUG | [Rank 51]: distributed setup: DistributedState(rank=51, world_size=112, group_local_rank=3, group_local_size=4, group_rank=12, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=3, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=3, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fc670977970>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fc670977bb0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fc670977ab0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,437 | xffl.learning.distributed |    DEBUG | [Rank 21]: distributed setup: DistributedState(rank=21, world_size=112, group_local_rank=1, group_local_size=4, group_rank=5, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=5, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=1, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f9ab37e2eb0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f9ab37e30f0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f9ab37e2ff0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,437 | xffl.learning.distributed |    DEBUG | [Rank 20]: distributed setup: DistributedState(rank=20, world_size=112, group_local_rank=0, group_local_size=4, group_rank=5, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=4, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=1, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f6105cdf330>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f6105cdf570>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f6105cdf470>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,437 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,437 | xffl.learning.distributed |    DEBUG | [Rank 33]: distributed setup: DistributedState(rank=33, world_size=112, group_local_rank=1, group_local_size=4, group_rank=8, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=1, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=2, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fab3359f6f0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fab3359f930>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fab3359f830>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,374 | xffl.learning.distributed |    DEBUG | [Rank 64]: distributed setup: DistributedState(rank=64, world_size=112, group_local_rank=0, group_local_size=4, group_rank=16, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=0, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=4, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f5abf5df2b0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f5abf5df4f0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f5abf5df3f0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,437 | xffl.learning.distributed |    DEBUG | [Rank 100]: distributed setup: DistributedState(rank=100, world_size=112, group_local_rank=0, group_local_size=4, group_rank=25, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=4, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=6, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f00469eaef0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f00469eb030>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f00469eb0f0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,438 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,437 | xffl.learning.distributed |    DEBUG | [Rank 15]: distributed setup: DistributedState(rank=15, world_size=112, group_local_rank=3, group_local_size=4, group_rank=3, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=15, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=0, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f244cf63070>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f244cf632b0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f244cf631b0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,375 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,375 | xffl.learning.distributed |    DEBUG | [Rank 84]: distributed setup: DistributedState(rank=84, world_size=112, group_local_rank=0, group_local_size=4, group_rank=21, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=4, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=5, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7facd5167570>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7facd51676b0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7facd51676f0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,375 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,375 | xffl.learning.distributed |    DEBUG | [Rank 82]: distributed setup: DistributedState(rank=82, world_size=112, group_local_rank=2, group_local_size=4, group_rank=20, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=2, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=5, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f2eea716870>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f2eea716ab0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f2eea7169b0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,375 | xffl.learning.distributed |    DEBUG | [Rank 86]: distributed setup: DistributedState(rank=86, world_size=112, group_local_rank=2, group_local_size=4, group_rank=21, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=6, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=5, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f31533eb370>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f31533eb5b0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f31533eb4b0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,438 | xffl.learning.distributed |    DEBUG | [Rank 101]: distributed setup: DistributedState(rank=101, world_size=112, group_local_rank=1, group_local_size=4, group_rank=25, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=5, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=6, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7ff5622a67f0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7ff5622a6930>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7ff5622a69f0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,438 | xffl.learning.distributed |    DEBUG | [Rank 26]: distributed setup: DistributedState(rank=26, world_size=112, group_local_rank=2, group_local_size=4, group_rank=6, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=10, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=1, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f3aa77cfb70>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f3aa77cfdb0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f3aa77cfcb0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,375 | xffl.learning.distributed |    DEBUG | [Rank 65]: distributed setup: DistributedState(rank=65, world_size=112, group_local_rank=1, group_local_size=4, group_rank=16, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=1, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=4, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7ff97379f9f0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7ff97379fc30>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7ff97379fb30>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,438 | xffl.learning.distributed |    DEBUG | [Rank 34]: distributed setup: DistributedState(rank=34, world_size=112, group_local_rank=2, group_local_size=4, group_rank=8, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=2, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=2, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fee49abb6b0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fee49abb8f0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fee49abb7f0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,438 | xffl.learning.distributed |    DEBUG | [Rank 22]: distributed setup: DistributedState(rank=22, world_size=112, group_local_rank=2, group_local_size=4, group_rank=5, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=6, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=1, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f2ba6ee2e70>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f2ba6ee2f70>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f2ba6ee2fb0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,438 | xffl.learning.distributed |    DEBUG | [Rank 36]: distributed setup: DistributedState(rank=36, world_size=112, group_local_rank=0, group_local_size=4, group_rank=9, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=4, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=2, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f8f3bb776b0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f8f3bb778f0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f8f3bb777f0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,438 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,439 | xffl.learning.distributed |    DEBUG | [Rank 27]: distributed setup: DistributedState(rank=27, world_size=112, group_local_rank=3, group_local_size=4, group_rank=6, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=11, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=1, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f043e25ed30>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f043e25ef70>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f043e25ee70>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,376 | xffl.learning.distributed |    DEBUG | [Rank 88]: distributed setup: DistributedState(rank=88, world_size=112, group_local_rank=0, group_local_size=4, group_rank=22, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=8, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=5, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f6aafd1ae30>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f6aafd1b070>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f6aafd1b170>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,439 | xffl.learning.distributed |    DEBUG | [Rank 53]: distributed setup: DistributedState(rank=53, world_size=112, group_local_rank=1, group_local_size=4, group_rank=13, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=5, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=3, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f9cb34db570>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f9cb34db7b0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f9cb34db6b0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,376 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,376 | xffl.learning.distributed |    DEBUG | [Rank 87]: distributed setup: DistributedState(rank=87, world_size=112, group_local_rank=3, group_local_size=4, group_rank=21, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=7, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=5, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f205fe7b670>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f205fe7b8b0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f205fe7b7b0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,439 | xffl.learning.distributed |    DEBUG | [Rank 23]: distributed setup: DistributedState(rank=23, world_size=112, group_local_rank=3, group_local_size=4, group_rank=5, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=7, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=1, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f2f99d8ffb0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f2f99dc41f0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f2f99dc40f0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,439 | xffl.learning.distributed |    DEBUG | [Rank 55]: distributed setup: DistributedState(rank=55, world_size=112, group_local_rank=3, group_local_size=4, group_rank=13, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=7, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=3, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fa16fa8c4b0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fa16fa8c6f0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fa16fa8c5f0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,439 | xffl.learning.distributed |    DEBUG | [Rank 56]: distributed setup: DistributedState(rank=56, world_size=112, group_local_rank=0, group_local_size=4, group_rank=14, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=8, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=3, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fd40f82f570>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fd40f82f7b0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fd40f82f6b0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,439 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,376 | xffl.learning.distributed |    DEBUG | [Rank 89]: distributed setup: DistributedState(rank=89, world_size=112, group_local_rank=1, group_local_size=4, group_rank=22, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=9, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=5, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fc938ae31b0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fc938ae33f0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fc938ae32f0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,439 | xffl.learning.distributed |    DEBUG | [Rank 25]: distributed setup: DistributedState(rank=25, world_size=112, group_local_rank=1, group_local_size=4, group_rank=6, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=9, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=1, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fb242bbb2f0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fb242bbb530>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fb242bbb430>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,439 | xffl.learning.distributed |    DEBUG | [Rank 24]: distributed setup: DistributedState(rank=24, world_size=112, group_local_rank=0, group_local_size=4, group_rank=6, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=8, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=1, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7faaa67ef0f0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7faaa67ef330>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7faaa67ef230>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,439 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,439 | xffl.learning.distributed |    DEBUG | [Rank 29]: distributed setup: DistributedState(rank=29, world_size=112, group_local_rank=1, group_local_size=4, group_rank=7, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=13, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=1, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fc91ad97970>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fc91ad97bb0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fc91ad97ab0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.distributed |    DEBUG | [Rank 28]: distributed setup: DistributedState(rank=28, world_size=112, group_local_rank=0, group_local_size=4, group_rank=7, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=12, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=1, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f53af9778b0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f53af977af0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f53af977bf0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,439 | xffl.learning.distributed |    DEBUG | [Rank 108]: distributed setup: DistributedState(rank=108, world_size=112, group_local_rank=0, group_local_size=4, group_rank=27, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=12, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=6, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f916f236c70>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f916f236db0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f916f236fb0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.distributed |    DEBUG | [Rank 57]: distributed setup: DistributedState(rank=57, world_size=112, group_local_rank=1, group_local_size=4, group_rank=14, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=9, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=3, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f2c104ef570>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f2c104ef7b0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f2c104ef6b0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.distributed |    DEBUG | [Rank 49]: distributed setup: DistributedState(rank=49, world_size=112, group_local_rank=1, group_local_size=4, group_rank=12, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=1, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=3, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fbb2aac30f0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fbb2aac32f0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fbb2aac31f0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,377 | xffl.learning.distributed |    DEBUG | [Rank 90]: distributed setup: DistributedState(rank=90, world_size=112, group_local_rank=2, group_local_size=4, group_rank=22, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=10, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=5, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f675f0632f0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f675f063530>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f675f063430>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,439 | xffl.learning.distributed |    DEBUG | [Rank 41]: distributed setup: DistributedState(rank=41, world_size=112, group_local_rank=1, group_local_size=4, group_rank=10, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=9, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=2, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7ff8dfba6eb0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7ff8dfba70f0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7ff8dfba6ff0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.distributed |    DEBUG | [Rank 54]: distributed setup: DistributedState(rank=54, world_size=112, group_local_rank=2, group_local_size=4, group_rank=13, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=6, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=3, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7ff687d28030>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7ff687d28270>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7ff687d28170>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.distributed |    DEBUG | [Rank 59]: distributed setup: DistributedState(rank=59, world_size=112, group_local_rank=3, group_local_size=4, group_rank=14, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=11, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=3, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fe8b8ff3770>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fe8b8ff39b0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fe8b8ff38b0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,377 | xffl.learning.distributed |    DEBUG | [Rank 79]: distributed setup: DistributedState(rank=79, world_size=112, group_local_rank=3, group_local_size=4, group_rank=19, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=15, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=4, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f9e86e36db0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f9e86e36ff0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f9e86e36ef0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.distributed |    DEBUG | [Rank 109]: distributed setup: DistributedState(rank=109, world_size=112, group_local_rank=1, group_local_size=4, group_rank=27, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=13, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=6, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fed608eb330>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fed608eb470>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fed608eb530>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,377 | xffl.learning.distributed |    DEBUG | [Rank 92]: distributed setup: DistributedState(rank=92, world_size=112, group_local_rank=0, group_local_size=4, group_rank=23, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=12, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=5, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fcfd125b9f0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fcfd125bc30>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fcfd125bb30>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,377 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.distributed |    DEBUG | [Rank 35]: distributed setup: DistributedState(rank=35, world_size=112, group_local_rank=3, group_local_size=4, group_rank=8, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=3, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=2, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f94441daf70>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f94441db1b0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f94441db0b0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.distributed |    DEBUG | [Rank 40]: distributed setup: DistributedState(rank=40, world_size=112, group_local_rank=0, group_local_size=4, group_rank=10, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=8, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=2, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f65da7ebc70>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f65da7ebeb0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f65da7ebdb0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.distributed |    DEBUG | [Rank 58]: distributed setup: DistributedState(rank=58, world_size=112, group_local_rank=2, group_local_size=4, group_rank=14, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=10, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=3, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f010fc13af0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f010fc13d30>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f010fc13c30>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.distributed |    DEBUG | [Rank 47]: distributed setup: DistributedState(rank=47, world_size=112, group_local_rank=3, group_local_size=4, group_rank=11, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=15, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=2, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f0812a3be30>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f0812a3be70>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f0812a640f0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.distributed |    DEBUG | [Rank 102]: distributed setup: DistributedState(rank=102, world_size=112, group_local_rank=2, group_local_size=4, group_rank=25, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=6, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=6, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f1bec6d74b0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f1bec6d75f0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f1bec6d76b0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.distributed |    DEBUG | [Rank 103]: distributed setup: DistributedState(rank=103, world_size=112, group_local_rank=3, group_local_size=4, group_rank=25, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=7, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=6, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fdf01eb6b30>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fdf01eb6c70>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fdf01eb6d30>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.distributed |    DEBUG | [Rank 111]: distributed setup: DistributedState(rank=111, world_size=112, group_local_rank=3, group_local_size=4, group_rank=27, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=15, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=6, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7ff606e43870>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7ff606e439b0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7ff606e43a70>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.distributed |    DEBUG | [Rank 105]: distributed setup: DistributedState(rank=105, world_size=112, group_local_rank=1, group_local_size=4, group_rank=26, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=9, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=6, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fa02988aaf0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fa02988ac30>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fa02988acf0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.distributed |    DEBUG | [Rank 104]: distributed setup: DistributedState(rank=104, world_size=112, group_local_rank=0, group_local_size=4, group_rank=26, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=8, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=6, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f911a2e65f0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f911a2e6730>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f911a2e6930>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,377 | xffl.learning.distributed |    DEBUG | [Rank 91]: distributed setup: DistributedState(rank=91, world_size=112, group_local_rank=3, group_local_size=4, group_rank=22, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=11, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=5, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fe959652eb0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fe9596530f0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fe959652ff0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,377 | xffl.learning.distributed |    DEBUG | [Rank 67]: distributed setup: DistributedState(rank=67, world_size=112, group_local_rank=3, group_local_size=4, group_rank=16, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=3, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=4, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f5176e834b0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f5176e836f0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f5176e837f0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.distributed |    DEBUG | [Rank 63]: distributed setup: DistributedState(rank=63, world_size=112, group_local_rank=3, group_local_size=4, group_rank=15, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=15, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=3, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f3a127db170>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f3a127db3b0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f3a127db2b0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.distributed |    DEBUG | [Rank 60]: distributed setup: DistributedState(rank=60, world_size=112, group_local_rank=0, group_local_size=4, group_rank=15, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=12, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=3, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f8bace1aa30>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f8bace1ac70>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f8bace1ab70>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.distributed |    DEBUG | [Rank 110]: distributed setup: DistributedState(rank=110, world_size=112, group_local_rank=2, group_local_size=4, group_rank=27, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=14, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=6, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f39270d3ab0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f39270d3bf0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f39270d3cb0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.distributed |    DEBUG | [Rank 61]: distributed setup: DistributedState(rank=61, world_size=112, group_local_rank=1, group_local_size=4, group_rank=15, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=13, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=3, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f0589e42fb0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f0589e431f0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f0589e430f0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.distributed |    DEBUG | [Rank 62]: distributed setup: DistributedState(rank=62, world_size=112, group_local_rank=2, group_local_size=4, group_rank=15, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=14, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=3, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f05d29183b0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f05d29185f0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f05d29184f0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.distributed |    DEBUG | [Rank 42]: distributed setup: DistributedState(rank=42, world_size=112, group_local_rank=2, group_local_size=4, group_rank=10, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=10, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=2, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fe3a857b930>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fe3a857bb70>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fe3a857bc70>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.distributed |    DEBUG | [Rank 37]: distributed setup: DistributedState(rank=37, world_size=112, group_local_rank=1, group_local_size=4, group_rank=9, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=5, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=2, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f2e3cc0f4f0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f2e3cc0f730>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f2e3cc0f630>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,377 | xffl.learning.distributed |    DEBUG | [Rank 73]: distributed setup: DistributedState(rank=73, world_size=112, group_local_rank=1, group_local_size=4, group_rank=18, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=9, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=4, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fe61950efb0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fe61950f1f0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fe61950f0f0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.distributed |    DEBUG | [Rank 30]: distributed setup: DistributedState(rank=30, world_size=112, group_local_rank=2, group_local_size=4, group_rank=7, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=14, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=1, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f6520fd6ff0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f6520fd7230>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f6520fd7130>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.distributed |    DEBUG | [Rank 31]: distributed setup: DistributedState(rank=31, world_size=112, group_local_rank=3, group_local_size=4, group_rank=7, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=15, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=1, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f7b5029b2b0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f7b5029b4f0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f7b5029b3f0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,441 | xffl.learning.distributed |    DEBUG | [Rank 44]: distributed setup: DistributedState(rank=44, world_size=112, group_local_rank=0, group_local_size=4, group_rank=11, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=12, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=2, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fe72c517770>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fe72c517970>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fe72c517870>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,441 | xffl.learning.distributed |    DEBUG | [Rank 39]: distributed setup: DistributedState(rank=39, world_size=112, group_local_rank=3, group_local_size=4, group_rank=9, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=7, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=2, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f7e3ee5ef70>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f7e3ee5f1b0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f7e3ee5f0b0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,377 | xffl.learning.distributed |    DEBUG | [Rank 70]: distributed setup: DistributedState(rank=70, world_size=112, group_local_rank=2, group_local_size=4, group_rank=17, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=6, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=4, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f155e7cb670>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f155e7cb870>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f155e7cb770>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,377 | xffl.learning.distributed |    DEBUG | [Rank 68]: distributed setup: DistributedState(rank=68, world_size=112, group_local_rank=0, group_local_size=4, group_rank=17, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=4, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=4, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f45a84075b0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f45a84077f0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f45a84076f0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,378 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,441 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,378 | xffl.learning.distributed |    DEBUG | [Rank 76]: distributed setup: DistributedState(rank=76, world_size=112, group_local_rank=0, group_local_size=4, group_rank=19, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=12, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=4, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f8e0b4037b0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f8e0b4039f0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f8e0b4038f0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,378 | xffl.learning.distributed |    DEBUG | [Rank 78]: distributed setup: DistributedState(rank=78, world_size=112, group_local_rank=2, group_local_size=4, group_rank=19, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=14, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=4, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fa1851f30f0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fa1851f3330>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fa1851f3230>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,377 | xffl.learning.distributed |    DEBUG | [Rank 93]: distributed setup: DistributedState(rank=93, world_size=112, group_local_rank=1, group_local_size=4, group_rank=23, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=13, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=5, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fb3cfdb6e30>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fb3cfdb7070>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fb3cfdb6f70>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,377 | xffl.learning.distributed |    DEBUG | [Rank 94]: distributed setup: DistributedState(rank=94, world_size=112, group_local_rank=2, group_local_size=4, group_rank=23, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=14, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=5, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f760df1f0f0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f760df1f2f0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f760df1f1f0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,378 | xffl.learning.distributed |    DEBUG | [Rank 69]: distributed setup: DistributedState(rank=69, world_size=112, group_local_rank=1, group_local_size=4, group_rank=17, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=5, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=4, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7ff7b04f7970>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7ff7b04f7bb0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7ff7b04f7ab0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,378 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,378 | xffl.learning.distributed |    DEBUG | [Rank 77]: distributed setup: DistributedState(rank=77, world_size=112, group_local_rank=1, group_local_size=4, group_rank=19, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=13, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=4, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f4da066ab70>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f4da066adb0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f4da066acb0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,378 | xffl.learning.distributed |    DEBUG | [Rank 66]: distributed setup: DistributedState(rank=66, world_size=112, group_local_rank=2, group_local_size=4, group_rank=16, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=0, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=2, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=4, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f3b21336530>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f3b21336770>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f3b21336670>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,378 | xffl.learning.distributed |    DEBUG | [Rank 95]: distributed setup: DistributedState(rank=95, world_size=112, group_local_rank=3, group_local_size=4, group_rank=23, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=15, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=5, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f728072f270>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f728072f4b0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f728072f3b0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,378 | xffl.learning.distributed |    DEBUG | [Rank 72]: distributed setup: DistributedState(rank=72, world_size=112, group_local_rank=0, group_local_size=4, group_rank=18, group_world_size=28, replica_local_rank=0, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=8, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=4, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f7136c5c230>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f7136c5c470>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f7136c5c370>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,440 | xffl.learning.distributed |    DEBUG | [Rank 43]: distributed setup: DistributedState(rank=43, world_size=112, group_local_rank=3, group_local_size=4, group_rank=10, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=11, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=2, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f53b39d3870>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f53b39d3ab0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f53b39d39b0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,441 | xffl.learning.distributed |    DEBUG | [Rank 45]: distributed setup: DistributedState(rank=45, world_size=112, group_local_rank=1, group_local_size=4, group_rank=11, group_world_size=28, replica_local_rank=1, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=13, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=2, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f0bd1c8b3f0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f0bd1c8b630>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f0bd1c8b530>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,441 | xffl.learning.distributed |    DEBUG | [Rank 46]: distributed setup: DistributedState(rank=46, world_size=112, group_local_rank=2, group_local_size=4, group_rank=11, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=3, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=14, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=2, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f7e7ffa37f0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f7e7ffa3a30>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f7e7ffa3930>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,378 | xffl.learning.utils |    DEBUG | Preloading: /leonardo_scratch/fast/uToID_bench/xffl/models/llama3.1-8b[0m
[38;5;39m2025-03-26 01:16:40,378 | xffl.learning.distributed |    DEBUG | [Rank 74]: distributed setup: DistributedState(rank=74, world_size=112, group_local_rank=2, group_local_size=4, group_rank=18, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=10, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=4, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f4d73517c70>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f4d73517eb0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f4d73517db0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,441 | xffl.learning.distributed |    DEBUG | [Rank 106]: distributed setup: DistributedState(rank=106, world_size=112, group_local_rank=2, group_local_size=4, group_rank=26, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=10, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=6, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f6653bc72f0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f6653bc7430>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f6653bc74f0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,441 | xffl.learning.distributed |    DEBUG | [Rank 107]: distributed setup: DistributedState(rank=107, world_size=112, group_local_rank=3, group_local_size=4, group_rank=26, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=11, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=6, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f77a35ab2b0>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f77a35ab3f0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f77a35ab4b0>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,378 | xffl.learning.distributed |    DEBUG | [Rank 71]: distributed setup: DistributedState(rank=71, world_size=112, group_local_rank=3, group_local_size=4, group_rank=17, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=7, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=4, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f2ea98b7e70>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f2ea98b7eb0>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f2ea98e0130>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,378 | xffl.learning.distributed |    DEBUG | [Rank 75]: distributed setup: DistributedState(rank=75, world_size=112, group_local_rank=3, group_local_size=4, group_rank=18, group_world_size=28, replica_local_rank=3, replica_local_size=4, replica_rank=2, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=11, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=4, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fa7afcbf430>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fa7afcbf670>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7fa7afcbf770>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,441 | xffl.learning.distributed |    DEBUG | [Rank 38]: distributed setup: DistributedState(rank=38, world_size=112, group_local_rank=2, group_local_size=4, group_rank=9, group_world_size=28, replica_local_rank=2, replica_local_size=4, replica_rank=1, replica_world_size=(4, 4, 4, 4, 4, 4, 4), federated_local_rank=6, federated_local_size=(16, 16, 16, 16, 16, 16, 16), federated_rank=2, federated_world_size=7, fsdp_mesh=None, hsdp_mesh=DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')), federated_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f6cbb29b230>, replica_group=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f6cbb29b470>, federation=<torch.distributed.distributed_c10d.ProcessGroup object at 0x7f6cbb29b370>, backend='nccl', master_addr='lrdn0001', master_port=29500, device='cuda')[0m
[38;5;39m2025-03-26 01:16:40,531 | xffl.learning.utils |    DEBUG | [Rank 0]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,536 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:40,538 | xffl.learning.utils |    DEBUG | [Rank 4]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,541 | xffl.learning.utils |    DEBUG | [Rank 16]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,542 | xffl.learning.utils |    DEBUG | [Rank 48]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,542 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:40,480 | xffl.learning.utils |    DEBUG | [Rank 80]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,543 | xffl.learning.utils |    DEBUG | [Rank 28]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,544 | xffl.learning.utils |    DEBUG | [Rank 60]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,544 | xffl.learning.utils |    DEBUG | [Rank 56]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,481 | xffl.learning.utils |    DEBUG | [Rank 88]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,545 | xffl.learning.utils |    DEBUG | [Rank 104]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,545 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:40,546 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:40,484 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:40,547 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:40,548 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:40,485 | xffl.learning.utils |    DEBUG | [Rank 92]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,548 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:40,485 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:40,549 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:40,550 | xffl.learning.utils |    DEBUG | [Rank 44]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,489 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:40,555 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:40,562 | xffl.learning.utils |    DEBUG | [Rank 96]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,564 | xffl.learning.utils |    DEBUG | [Rank 100]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,567 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:40,568 | xffl.learning.utils |    DEBUG | [Rank 32]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,569 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:40,571 | xffl.learning.utils |    DEBUG | [Rank 36]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,508 | xffl.learning.utils |    DEBUG | [Rank 72]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,572 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:40,510 | xffl.learning.utils |    DEBUG | [Rank 68]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,575 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:40,512 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:40,514 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:40,592 | xffl.learning.utils |    DEBUG | [Rank 24]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,593 | xffl.learning.utils |    DEBUG | [Rank 8]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,531 | xffl.learning.utils |    DEBUG | [Rank 84]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,596 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:40,597 | xffl.learning.utils |    DEBUG | [Rank 20]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,597 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:40,535 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:40,599 | xffl.learning.utils |    DEBUG | [Rank 40]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,599 | xffl.learning.utils |    DEBUG | [Rank 108]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,600 | xffl.learning.utils |    DEBUG | [Rank 12]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,601 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:40,603 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:40,540 | xffl.learning.utils |    DEBUG | [Rank 76]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,604 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:40,604 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:40,544 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:40,621 | xffl.learning.utils |    DEBUG | [Rank 52]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,562 | xffl.learning.utils |    DEBUG | [Rank 64]: assigned local execution device 0, initialisation device set to cpu; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:40,625 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:40,566 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,165 | xffl.learning.utils |    DEBUG | [Rank 19]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,167 | xffl.learning.utils |    DEBUG | [Rank 2]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,167 | xffl.learning.utils |    DEBUG | [Rank 34]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,106 | xffl.learning.utils |    DEBUG | [Rank 90]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,169 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,106 | xffl.learning.utils |    DEBUG | [Rank 91]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,172 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,172 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,110 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,110 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,175 | xffl.learning.utils |    DEBUG | [Rank 55]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,177 | xffl.learning.utils |    DEBUG | [Rank 103]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,178 | xffl.learning.utils |    DEBUG | [Rank 35]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,178 | xffl.learning.utils |    DEBUG | [Rank 18]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,180 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,116 | xffl.learning.utils |    DEBUG | [Rank 67]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,117 | xffl.learning.utils |    DEBUG | [Rank 66]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,181 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,182 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,182 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,183 | xffl.learning.utils |    DEBUG | [Rank 3]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,120 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,183 | xffl.learning.utils |    DEBUG | [Rank 22]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,121 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,122 | xffl.learning.utils |    DEBUG | [Rank 75]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,185 | xffl.learning.utils |    DEBUG | [Rank 58]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,187 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,187 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,188 | xffl.learning.utils |    DEBUG | [Rank 102]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,126 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,126 | xffl.learning.utils |    DEBUG | [Rank 71]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,190 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,191 | xffl.learning.utils |    DEBUG | [Rank 54]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,191 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,193 | xffl.learning.utils |    DEBUG | [Rank 59]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,130 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,131 | xffl.learning.utils |    DEBUG | [Rank 83]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,195 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,196 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,196 | xffl.learning.utils |    DEBUG | [Rank 107]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,198 | xffl.learning.utils |    DEBUG | [Rank 51]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,135 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,136 | xffl.learning.utils |    DEBUG | [Rank 86]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,137 | xffl.learning.utils |    DEBUG | [Rank 87]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,201 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,201 | xffl.learning.utils |    DEBUG | [Rank 50]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,201 | xffl.learning.utils |    DEBUG | [Rank 26]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,202 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,202 | xffl.learning.utils |    DEBUG | [Rank 106]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,141 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,141 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,204 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,204 | xffl.learning.utils |    DEBUG | [Rank 39]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,205 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,206 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,207 | xffl.learning.utils |    DEBUG | [Rank 23]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,207 | xffl.learning.utils |    DEBUG | [Rank 38]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,207 | xffl.learning.utils |    DEBUG | [Rank 10]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,145 | xffl.learning.utils |    DEBUG | [Rank 74]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,209 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,209 | xffl.learning.utils |    DEBUG | [Rank 43]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,210 | xffl.learning.utils |    DEBUG | [Rank 99]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,211 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,211 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,148 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,212 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,211 | xffl.learning.utils |    DEBUG | [Rank 27]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,213 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,151 | xffl.learning.utils |    DEBUG | [Rank 70]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,214 | xffl.learning.utils |    DEBUG | [Rank 7]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,214 | xffl.learning.utils |    DEBUG | [Rank 11]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,215 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,215 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,154 | xffl.learning.utils |    DEBUG | [Rank 82]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,218 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,155 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,218 | xffl.learning.utils |    DEBUG | [Rank 98]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,218 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,158 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,221 | xffl.learning.utils |    DEBUG | [Rank 57]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,221 | xffl.learning.utils |    DEBUG | [Rank 42]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,222 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,224 | xffl.learning.utils |    DEBUG | [Rank 6]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,225 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,225 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,228 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,168 | xffl.learning.utils |    DEBUG | [Rank 89]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,172 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,239 | xffl.learning.utils |    DEBUG | [Rank 1]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,243 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,246 | xffl.learning.utils |    DEBUG | [Rank 17]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,250 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,251 | xffl.learning.utils |    DEBUG | [Rank 9]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,252 | xffl.learning.utils |    DEBUG | [Rank 5]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,189 | xffl.learning.utils |    DEBUG | [Rank 85]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,255 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,255 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,193 | xffl.learning.utils |    DEBUG | [Rank 65]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,193 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,257 | xffl.learning.utils |    DEBUG | [Rank 105]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,257 | xffl.learning.utils |    DEBUG | [Rank 21]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,197 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,260 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,261 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,266 | xffl.learning.utils |    DEBUG | [Rank 53]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,270 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,208 | xffl.learning.utils |    DEBUG | [Rank 81]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,272 | xffl.learning.utils |    DEBUG | [Rank 101]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,273 | xffl.learning.utils |    DEBUG | [Rank 37]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,211 | xffl.learning.utils |    DEBUG | [Rank 73]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,211 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,276 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,276 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,277 | xffl.learning.utils |    DEBUG | [Rank 97]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,215 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,278 | xffl.learning.utils |    DEBUG | [Rank 33]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,279 | xffl.learning.utils |    DEBUG | [Rank 49]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,281 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,282 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,283 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,229 | xffl.learning.utils |    DEBUG | [Rank 69]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,294 | xffl.learning.utils |    DEBUG | [Rank 25]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,233 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,298 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,301 | xffl.learning.utils |    DEBUG | [Rank 41]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,305 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,532 | xffl.learning.utils |    DEBUG | [Rank 78]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,536 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,603 | xffl.learning.utils |    DEBUG | [Rank 46]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,605 | xffl.learning.utils |    DEBUG | [Rank 110]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,607 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,608 | xffl.learning.utils |    DEBUG | [Rank 63]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,610 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,611 | xffl.learning.utils |    DEBUG | [Rank 31]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,612 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,615 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,618 | xffl.learning.utils |    DEBUG | [Rank 47]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,618 | xffl.learning.utils |    DEBUG | [Rank 62]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,621 | xffl.learning.utils |    DEBUG | [Rank 111]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,621 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,622 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,624 | xffl.learning.utils |    DEBUG | [Rank 14]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,625 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,628 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,566 | xffl.learning.utils |    DEBUG | [Rank 79]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,566 | xffl.learning.utils |    DEBUG | [Rank 95]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,632 | xffl.learning.utils |    DEBUG | [Rank 15]: assigned local execution device 3, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,570 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,570 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,636 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,642 | xffl.learning.utils |    DEBUG | [Rank 30]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,646 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,585 | xffl.learning.utils |    DEBUG | [Rank 94]: assigned local execution device 2, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,589 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,687 | xffl.learning.utils |    DEBUG | [Rank 29]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,688 | xffl.learning.utils |    DEBUG | [Rank 13]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,691 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,692 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,633 | xffl.learning.utils |    DEBUG | [Rank 77]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,637 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,640 | xffl.learning.utils |    DEBUG | [Rank 93]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,643 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,707 | xffl.learning.utils |    DEBUG | [Rank 61]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,711 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,712 | xffl.learning.utils |    DEBUG | [Rank 109]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,715 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:42,720 | xffl.learning.utils |    DEBUG | [Rank 45]: assigned local execution device 1, initialisation device set to meta; meta initialization set to True[0m
[38;5;39m2025-03-26 01:16:42,724 | wandb.sdk.lib.gitlib |    DEBUG | git repository is invalid[0m
[38;5;39m2025-03-26 01:16:46,057 | xffl.learning.modelling |    DEBUG | [Rank 108]: is calling FSDP on device mesh DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,057 | xffl.learning.distributed |    DEBUG | [Rank 108]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,002 | xffl.learning.modelling |    DEBUG | [Rank 92]: is calling FSDP on device mesh DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,002 | xffl.learning.distributed |    DEBUG | [Rank 92]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,103 | xffl.learning.modelling |    DEBUG | [Rank 60]: is calling FSDP on device mesh DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,103 | xffl.learning.distributed |    DEBUG | [Rank 60]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,053 | xffl.learning.modelling |    DEBUG | [Rank 76]: is calling FSDP on device mesh DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,053 | xffl.learning.distributed |    DEBUG | [Rank 76]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,139 | xffl.learning.modelling |    DEBUG | [Rank 4]: is calling FSDP on device mesh DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,139 | xffl.learning.distributed |    DEBUG | [Rank 4]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,140 | xffl.learning.modelling |    DEBUG | [Rank 44]: is calling FSDP on device mesh DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,141 | xffl.learning.distributed |    DEBUG | [Rank 44]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,148 | xffl.learning.modelling |    DEBUG | [Rank 12]: is calling FSDP on device mesh DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,148 | xffl.learning.distributed |    DEBUG | [Rank 12]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,172 | xffl.learning.modelling |    DEBUG | [Rank 100]: is calling FSDP on device mesh DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,172 | xffl.learning.distributed |    DEBUG | [Rank 100]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,184 | xffl.learning.modelling |    DEBUG | [Rank 56]: is calling FSDP on device mesh DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,185 | xffl.learning.distributed |    DEBUG | [Rank 56]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,190 | xffl.learning.modelling |    DEBUG | [Rank 28]: is calling FSDP on device mesh DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,190 | xffl.learning.distributed |    DEBUG | [Rank 28]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,137 | xffl.learning.modelling |    DEBUG | [Rank 80]: is calling FSDP on device mesh DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,138 | xffl.learning.distributed |    DEBUG | [Rank 80]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,224 | xffl.learning.modelling |    DEBUG | [Rank 52]: is calling FSDP on device mesh DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,225 | xffl.learning.distributed |    DEBUG | [Rank 52]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,242 | xffl.learning.modelling |    DEBUG | [Rank 48]: is calling FSDP on device mesh DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,242 | xffl.learning.distributed |    DEBUG | [Rank 48]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,270 | xffl.learning.modelling |    DEBUG | [Rank 20]: is calling FSDP on device mesh DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,270 | xffl.learning.distributed |    DEBUG | [Rank 20]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,207 | xffl.learning.modelling |    DEBUG | [Rank 88]: is calling FSDP on device mesh DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,208 | xffl.learning.distributed |    DEBUG | [Rank 88]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,290 |         __main__ |    DEBUG | Model loading time: 5.16 seconds[0m
[38;5;39m2025-03-26 01:16:46,291 |         __main__ |    DEBUG | Training llama3.1-8b: 8030.26 million trainable parameters[0m
[38;5;39m2025-03-26 01:16:46,291 | xffl.learning.modelling |    DEBUG | [Rank 0]: is calling FSDP on device mesh DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,291 | xffl.learning.distributed |    DEBUG | [Rank 0]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,294 | xffl.learning.modelling |    DEBUG | [Rank 16]: is calling FSDP on device mesh DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,294 | xffl.learning.distributed |    DEBUG | [Rank 16]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,233 | xffl.learning.modelling |    DEBUG | [Rank 84]: is calling FSDP on device mesh DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,233 | xffl.learning.distributed |    DEBUG | [Rank 84]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,296 | xffl.learning.modelling |    DEBUG | [Rank 36]: is calling FSDP on device mesh DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,296 | xffl.learning.distributed |    DEBUG | [Rank 36]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,245 | xffl.learning.modelling |    DEBUG | [Rank 68]: is calling FSDP on device mesh DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,245 | xffl.learning.distributed |    DEBUG | [Rank 68]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,246 | xffl.learning.modelling |    DEBUG | [Rank 72]: is calling FSDP on device mesh DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,246 | xffl.learning.distributed |    DEBUG | [Rank 72]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,323 | xffl.learning.modelling |    DEBUG | [Rank 96]: is calling FSDP on device mesh DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,323 | xffl.learning.distributed |    DEBUG | [Rank 96]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,327 | xffl.learning.modelling |    DEBUG | [Rank 104]: is calling FSDP on device mesh DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,328 | xffl.learning.distributed |    DEBUG | [Rank 104]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,331 | xffl.learning.modelling |    DEBUG | [Rank 24]: is calling FSDP on device mesh DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,332 | xffl.learning.distributed |    DEBUG | [Rank 24]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,273 | xffl.learning.modelling |    DEBUG | [Rank 64]: is calling FSDP on device mesh DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,273 | xffl.learning.distributed |    DEBUG | [Rank 64]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,351 | xffl.learning.modelling |    DEBUG | [Rank 32]: is calling FSDP on device mesh DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,351 | xffl.learning.distributed |    DEBUG | [Rank 32]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,406 | xffl.learning.modelling |    DEBUG | [Rank 40]: is calling FSDP on device mesh DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,407 | xffl.learning.distributed |    DEBUG | [Rank 40]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,423 | xffl.learning.modelling |    DEBUG | [Rank 8]: is calling FSDP on device mesh DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,423 | xffl.learning.distributed |    DEBUG | [Rank 8]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,919 | xffl.learning.modelling |    DEBUG | [Rank 17]: is calling FSDP on device mesh DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,919 | xffl.learning.distributed |    DEBUG | [Rank 17]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,932 | xffl.learning.modelling |    DEBUG | [Rank 53]: is calling FSDP on device mesh DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,932 | xffl.learning.distributed |    DEBUG | [Rank 53]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,875 | xffl.learning.modelling |    DEBUG | [Rank 67]: is calling FSDP on device mesh DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,876 | xffl.learning.distributed |    DEBUG | [Rank 67]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,879 | xffl.learning.modelling |    DEBUG | [Rank 66]: is calling FSDP on device mesh DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,879 | xffl.learning.distributed |    DEBUG | [Rank 66]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,944 | xffl.learning.modelling |    DEBUG | [Rank 49]: is calling FSDP on device mesh DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,944 | xffl.learning.distributed |    DEBUG | [Rank 49]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,948 | xffl.learning.modelling |    DEBUG | [Rank 107]: is calling FSDP on device mesh DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,948 | xffl.learning.distributed |    DEBUG | [Rank 107]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,951 | xffl.learning.modelling |    DEBUG | [Rank 106]: is calling FSDP on device mesh DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,951 | xffl.learning.distributed |    DEBUG | [Rank 106]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,958 | xffl.learning.modelling |    DEBUG | [Rank 97]: is calling FSDP on device mesh DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,958 | xffl.learning.distributed |    DEBUG | [Rank 97]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,967 | xffl.learning.modelling |    DEBUG | [Rank 19]: is calling FSDP on device mesh DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,967 | xffl.learning.distributed |    DEBUG | [Rank 19]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,967 | xffl.learning.modelling |    DEBUG | [Rank 18]: is calling FSDP on device mesh DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,968 | xffl.learning.distributed |    DEBUG | [Rank 18]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,978 | xffl.learning.modelling |    DEBUG | [Rank 21]: is calling FSDP on device mesh DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,978 | xffl.learning.distributed |    DEBUG | [Rank 21]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,996 | xffl.learning.modelling |    DEBUG | [Rank 51]: is calling FSDP on device mesh DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,997 | xffl.learning.distributed |    DEBUG | [Rank 51]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,012 | xffl.learning.modelling |    DEBUG | [Rank 50]: is calling FSDP on device mesh DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,012 | xffl.learning.distributed |    DEBUG | [Rank 50]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,012 | xffl.learning.modelling |    DEBUG | [Rank 98]: is calling FSDP on device mesh DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,013 | xffl.learning.distributed |    DEBUG | [Rank 98]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,950 | xffl.learning.modelling |    DEBUG | [Rank 65]: is calling FSDP on device mesh DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,950 | xffl.learning.distributed |    DEBUG | [Rank 65]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,015 | xffl.learning.modelling |    DEBUG | [Rank 99]: is calling FSDP on device mesh DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,015 | xffl.learning.distributed |    DEBUG | [Rank 99]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:46,956 | xffl.learning.modelling |    DEBUG | [Rank 81]: is calling FSDP on device mesh DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:46,956 | xffl.learning.distributed |    DEBUG | [Rank 81]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,037 | xffl.learning.modelling |    DEBUG | [Rank 105]: is calling FSDP on device mesh DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,037 | xffl.learning.distributed |    DEBUG | [Rank 105]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,057 | xffl.learning.modelling |    DEBUG | [Rank 55]: is calling FSDP on device mesh DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,057 | xffl.learning.distributed |    DEBUG | [Rank 55]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,067 | xffl.learning.modelling |    DEBUG | [Rank 54]: is calling FSDP on device mesh DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,067 | xffl.learning.distributed |    DEBUG | [Rank 54]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,081 | xffl.learning.modelling |    DEBUG | [Rank 22]: is calling FSDP on device mesh DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,081 | xffl.learning.distributed |    DEBUG | [Rank 22]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,030 | xffl.learning.modelling |    DEBUG | [Rank 90]: is calling FSDP on device mesh DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,030 | xffl.learning.distributed |    DEBUG | [Rank 90]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,031 | xffl.learning.modelling |    DEBUG | [Rank 91]: is calling FSDP on device mesh DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,031 | xffl.learning.distributed |    DEBUG | [Rank 91]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,096 | xffl.learning.modelling |    DEBUG | [Rank 23]: is calling FSDP on device mesh DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,096 | xffl.learning.distributed |    DEBUG | [Rank 23]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,097 | xffl.learning.modelling |    DEBUG | [Rank 25]: is calling FSDP on device mesh DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,097 | xffl.learning.distributed |    DEBUG | [Rank 25]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,036 | xffl.learning.modelling |    DEBUG | [Rank 85]: is calling FSDP on device mesh DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,036 | xffl.learning.distributed |    DEBUG | [Rank 85]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,037 | xffl.learning.modelling |    DEBUG | [Rank 82]: is calling FSDP on device mesh DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,037 | xffl.learning.distributed |    DEBUG | [Rank 82]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,110 | xffl.learning.modelling |    DEBUG | [Rank 34]: is calling FSDP on device mesh DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,110 | xffl.learning.distributed |    DEBUG | [Rank 34]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,110 | xffl.learning.modelling |    DEBUG | [Rank 101]: is calling FSDP on device mesh DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,111 | xffl.learning.distributed |    DEBUG | [Rank 101]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,048 | xffl.learning.modelling |    DEBUG | [Rank 83]: is calling FSDP on device mesh DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,048 | xffl.learning.distributed |    DEBUG | [Rank 83]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,116 | xffl.learning.modelling |    DEBUG | [Rank 35]: is calling FSDP on device mesh DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,116 | xffl.learning.distributed |    DEBUG | [Rank 35]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,123 | xffl.learning.modelling |    DEBUG | [Rank 5]: is calling FSDP on device mesh DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,123 | xffl.learning.distributed |    DEBUG | [Rank 5]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,127 | xffl.learning.modelling |    DEBUG | [Rank 57]: is calling FSDP on device mesh DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,127 | xffl.learning.distributed |    DEBUG | [Rank 57]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,131 | xffl.learning.modelling |    DEBUG | [Rank 1]: is calling FSDP on device mesh DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,131 | xffl.learning.distributed |    DEBUG | [Rank 1]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,149 | xffl.learning.modelling |    DEBUG | [Rank 11]: is calling FSDP on device mesh DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,149 | xffl.learning.distributed |    DEBUG | [Rank 11]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,151 | xffl.learning.modelling |    DEBUG | [Rank 10]: is calling FSDP on device mesh DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,151 | xffl.learning.distributed |    DEBUG | [Rank 10]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,155 | xffl.learning.modelling |    DEBUG | [Rank 2]: is calling FSDP on device mesh DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,155 | xffl.learning.distributed |    DEBUG | [Rank 2]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,092 | xffl.learning.modelling |    DEBUG | [Rank 87]: is calling FSDP on device mesh DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,093 | xffl.learning.distributed |    DEBUG | [Rank 87]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,156 | xffl.learning.modelling |    DEBUG | [Rank 9]: is calling FSDP on device mesh DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,156 | xffl.learning.distributed |    DEBUG | [Rank 9]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,094 | xffl.learning.modelling |    DEBUG | [Rank 86]: is calling FSDP on device mesh DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,094 | xffl.learning.distributed |    DEBUG | [Rank 86]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,094 | xffl.learning.modelling |    DEBUG | [Rank 89]: is calling FSDP on device mesh DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,095 | xffl.learning.distributed |    DEBUG | [Rank 89]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,159 | xffl.learning.modelling |    DEBUG | [Rank 33]: is calling FSDP on device mesh DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,160 | xffl.learning.distributed |    DEBUG | [Rank 33]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,168 | xffl.learning.modelling |    DEBUG | [Rank 3]: is calling FSDP on device mesh DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,168 | xffl.learning.distributed |    DEBUG | [Rank 3]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,184 | xffl.learning.modelling |    DEBUG | [Rank 43]: is calling FSDP on device mesh DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,184 | xffl.learning.distributed |    DEBUG | [Rank 43]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,186 | xffl.learning.modelling |    DEBUG | [Rank 42]: is calling FSDP on device mesh DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,186 | xffl.learning.distributed |    DEBUG | [Rank 42]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,188 | xffl.learning.modelling |    DEBUG | [Rank 26]: is calling FSDP on device mesh DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,188 | xffl.learning.distributed |    DEBUG | [Rank 26]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,199 | xffl.learning.modelling |    DEBUG | [Rank 27]: is calling FSDP on device mesh DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,199 | xffl.learning.distributed |    DEBUG | [Rank 27]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,139 | xffl.learning.modelling |    DEBUG | [Rank 73]: is calling FSDP on device mesh DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,139 | xffl.learning.distributed |    DEBUG | [Rank 73]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,154 | xffl.learning.modelling |    DEBUG | [Rank 69]: is calling FSDP on device mesh DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,154 | xffl.learning.distributed |    DEBUG | [Rank 69]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,219 | xffl.learning.modelling |    DEBUG | [Rank 103]: is calling FSDP on device mesh DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,220 | xffl.learning.distributed |    DEBUG | [Rank 103]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,221 | xffl.learning.modelling |    DEBUG | [Rank 102]: is calling FSDP on device mesh DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,221 | xffl.learning.distributed |    DEBUG | [Rank 102]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,237 | xffl.learning.modelling |    DEBUG | [Rank 37]: is calling FSDP on device mesh DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,238 | xffl.learning.distributed |    DEBUG | [Rank 37]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,178 | xffl.learning.modelling |    DEBUG | [Rank 93]: is calling FSDP on device mesh DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,178 | xffl.learning.distributed |    DEBUG | [Rank 93]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,267 | xffl.learning.modelling |    DEBUG | [Rank 41]: is calling FSDP on device mesh DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,267 | xffl.learning.distributed |    DEBUG | [Rank 41]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,268 | xffl.learning.modelling |    DEBUG | [Rank 13]: is calling FSDP on device mesh DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,268 | xffl.learning.distributed |    DEBUG | [Rank 13]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,270 | xffl.learning.modelling |    DEBUG | [Rank 59]: is calling FSDP on device mesh DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,270 | xffl.learning.distributed |    DEBUG | [Rank 59]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,209 | xffl.learning.modelling |    DEBUG | [Rank 71]: is calling FSDP on device mesh DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,209 | xffl.learning.distributed |    DEBUG | [Rank 71]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,209 | xffl.learning.modelling |    DEBUG | [Rank 70]: is calling FSDP on device mesh DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,209 | xffl.learning.distributed |    DEBUG | [Rank 70]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,279 | xffl.learning.modelling |    DEBUG | [Rank 58]: is calling FSDP on device mesh DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,279 | xffl.learning.distributed |    DEBUG | [Rank 58]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,223 | xffl.learning.modelling |    DEBUG | [Rank 75]: is calling FSDP on device mesh DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,223 | xffl.learning.distributed |    DEBUG | [Rank 75]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,296 | xffl.learning.modelling |    DEBUG | [Rank 109]: is calling FSDP on device mesh DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,296 | xffl.learning.distributed |    DEBUG | [Rank 109]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,296 | xffl.learning.modelling |    DEBUG | [Rank 61]: is calling FSDP on device mesh DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,296 | xffl.learning.distributed |    DEBUG | [Rank 61]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,236 | xffl.learning.modelling |    DEBUG | [Rank 77]: is calling FSDP on device mesh DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,236 | xffl.learning.distributed |    DEBUG | [Rank 77]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,240 | xffl.learning.modelling |    DEBUG | [Rank 74]: is calling FSDP on device mesh DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,240 | xffl.learning.distributed |    DEBUG | [Rank 74]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,323 | xffl.learning.modelling |    DEBUG | [Rank 7]: is calling FSDP on device mesh DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,324 | xffl.learning.distributed |    DEBUG | [Rank 7]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,326 | xffl.learning.modelling |    DEBUG | [Rank 6]: is calling FSDP on device mesh DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,326 | xffl.learning.distributed |    DEBUG | [Rank 6]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,330 | xffl.learning.modelling |    DEBUG | [Rank 39]: is calling FSDP on device mesh DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,330 | xffl.learning.distributed |    DEBUG | [Rank 39]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,333 | xffl.learning.modelling |    DEBUG | [Rank 38]: is calling FSDP on device mesh DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,333 | xffl.learning.distributed |    DEBUG | [Rank 38]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,362 | xffl.learning.modelling |    DEBUG | [Rank 29]: is calling FSDP on device mesh DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,363 | xffl.learning.distributed |    DEBUG | [Rank 29]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,379 | xffl.learning.modelling |    DEBUG | [Rank 45]: is calling FSDP on device mesh DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,379 | xffl.learning.distributed |    DEBUG | [Rank 45]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,335 | xffl.learning.modelling |    DEBUG | [Rank 94]: is calling FSDP on device mesh DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,335 | xffl.learning.distributed |    DEBUG | [Rank 94]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,335 | xffl.learning.modelling |    DEBUG | [Rank 95]: is calling FSDP on device mesh DeviceMesh('cuda', [[80, 81, 82, 83], [84, 85, 86, 87], [88, 89, 90, 91], [92, 93, 94, 95]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,335 | xffl.learning.distributed |    DEBUG | [Rank 95]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,430 | xffl.learning.modelling |    DEBUG | [Rank 15]: is calling FSDP on device mesh DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,431 | xffl.learning.distributed |    DEBUG | [Rank 15]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,438 | xffl.learning.modelling |    DEBUG | [Rank 14]: is calling FSDP on device mesh DeviceMesh('cuda', [[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,438 | xffl.learning.distributed |    DEBUG | [Rank 14]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,447 | xffl.learning.modelling |    DEBUG | [Rank 78]: is calling FSDP on device mesh DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,447 | xffl.learning.distributed |    DEBUG | [Rank 78]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,450 | xffl.learning.modelling |    DEBUG | [Rank 79]: is calling FSDP on device mesh DeviceMesh('cuda', [[64, 65, 66, 67], [68, 69, 70, 71], [72, 73, 74, 75], [76, 77, 78, 79]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,450 | xffl.learning.distributed |    DEBUG | [Rank 79]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,516 | xffl.learning.modelling |    DEBUG | [Rank 47]: is calling FSDP on device mesh DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,517 | xffl.learning.distributed |    DEBUG | [Rank 47]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,517 | xffl.learning.modelling |    DEBUG | [Rank 46]: is calling FSDP on device mesh DeviceMesh('cuda', [[32, 33, 34, 35], [36, 37, 38, 39], [40, 41, 42, 43], [44, 45, 46, 47]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,518 | xffl.learning.distributed |    DEBUG | [Rank 46]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,534 | xffl.learning.modelling |    DEBUG | [Rank 30]: is calling FSDP on device mesh DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,534 | xffl.learning.distributed |    DEBUG | [Rank 30]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,535 | xffl.learning.modelling |    DEBUG | [Rank 31]: is calling FSDP on device mesh DeviceMesh('cuda', [[16, 17, 18, 19], [20, 21, 22, 23], [24, 25, 26, 27], [28, 29, 30, 31]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,535 | xffl.learning.distributed |    DEBUG | [Rank 31]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,542 | xffl.learning.modelling |    DEBUG | [Rank 63]: is calling FSDP on device mesh DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,542 | xffl.learning.distributed |    DEBUG | [Rank 63]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,543 | xffl.learning.modelling |    DEBUG | [Rank 62]: is calling FSDP on device mesh DeviceMesh('cuda', [[48, 49, 50, 51], [52, 53, 54, 55], [56, 57, 58, 59], [60, 61, 62, 63]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,544 | xffl.learning.distributed |    DEBUG | [Rank 62]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,561 | xffl.learning.modelling |    DEBUG | [Rank 110]: is calling FSDP on device mesh DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,561 | xffl.learning.distributed |    DEBUG | [Rank 110]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;39m2025-03-26 01:16:47,579 | xffl.learning.modelling |    DEBUG | [Rank 111]: is calling FSDP on device mesh DeviceMesh('cuda', [[96, 97, 98, 99], [100, 101, 102, 103], [104, 105, 106, 107], [108, 109, 110, 111]], mesh_dim_names=('replica', 'shard')) with meta initialization True[0m
[38;5;39m2025-03-26 01:16:47,579 | xffl.learning.distributed |    DEBUG | [Rank 111]: Activating "ShardingStrategy.HYBRID_SHARD" sharding strategy[0m
[38;5;196m2025-03-26 01:16:54,874 |         __main__ |    ERROR | CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 2 has a total capacity of 63.42 GiB of which 835.31 MiB is free. Process 1556126 has 55.68 GiB memory in use. Including non-PyTorch memory, this process has 6.92 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 69.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 589, in _init_param_handle_from_module
    _materialize_with_param_init_fn(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 898, in _materialize_with_param_init_fn
    param_init_fn(module)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 70, in <lambda>
    layer.to_empty(device=current_device, recurse=False)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1195, in to_empty
    return self._apply(
           ^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 930, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1196, in <lambda>
    lambda t: torch.empty_like(t, device=device), recurse=recurse
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_prims_common/wrappers.py", line 291, in _fn
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_refs/__init__.py", line 5003, in empty_like
    return torch.empty_permuted(
           ^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 2 has a total capacity of 63.42 GiB of which 835.31 MiB is free. Process 1556126 has 55.68 GiB memory in use. Including non-PyTorch memory, this process has 6.92 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 69.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:54,871 |         __main__ |    ERROR | CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 1 has a total capacity of 63.42 GiB of which 835.31 MiB is free. Process 1556124 has 55.68 GiB memory in use. Including non-PyTorch memory, this process has 6.92 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 69.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 589, in _init_param_handle_from_module
    _materialize_with_param_init_fn(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 898, in _materialize_with_param_init_fn
    param_init_fn(module)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 70, in <lambda>
    layer.to_empty(device=current_device, recurse=False)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1195, in to_empty
    return self._apply(
           ^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 930, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1196, in <lambda>
    lambda t: torch.empty_like(t, device=device), recurse=recurse
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_prims_common/wrappers.py", line 291, in _fn
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_refs/__init__.py", line 5003, in empty_like
    return torch.empty_permuted(
           ^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 1 has a total capacity of 63.42 GiB of which 835.31 MiB is free. Process 1556124 has 55.68 GiB memory in use. Including non-PyTorch memory, this process has 6.92 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 69.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:54,877 |         __main__ |    ERROR | CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 3 has a total capacity of 63.42 GiB of which 977.31 MiB is free. Process 1556127 has 55.61 GiB memory in use. Including non-PyTorch memory, this process has 6.85 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 69.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 589, in _init_param_handle_from_module
    _materialize_with_param_init_fn(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 898, in _materialize_with_param_init_fn
    param_init_fn(module)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 70, in <lambda>
    layer.to_empty(device=current_device, recurse=False)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1195, in to_empty
    return self._apply(
           ^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 930, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1196, in <lambda>
    lambda t: torch.empty_like(t, device=device), recurse=recurse
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_prims_common/wrappers.py", line 291, in _fn
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_refs/__init__.py", line 5003, in empty_like
    return torch.empty_permuted(
           ^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 3 has a total capacity of 63.42 GiB of which 977.31 MiB is free. Process 1556127 has 55.61 GiB memory in use. Including non-PyTorch memory, this process has 6.85 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 69.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-l1xwdaja[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-l1xwdaja/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-dgvdehhk[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-dgvdehhk/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-ontcdem8[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-ontcdem8/logs[0m
[38;5;196m2025-03-26 01:16:54,876 |         __main__ |    ERROR | CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 1 has a total capacity of 63.42 GiB of which 815.31 MiB is free. Process 3199127 has 55.64 GiB memory in use. Including non-PyTorch memory, this process has 6.98 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 129.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 589, in _init_param_handle_from_module
    _materialize_with_param_init_fn(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 898, in _materialize_with_param_init_fn
    param_init_fn(module)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 70, in <lambda>
    layer.to_empty(device=current_device, recurse=False)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1195, in to_empty
    return self._apply(
           ^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 930, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1196, in <lambda>
    lambda t: torch.empty_like(t, device=device), recurse=recurse
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_prims_common/wrappers.py", line 291, in _fn
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_refs/__init__.py", line 5003, in empty_like
    return torch.empty_permuted(
           ^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 1 has a total capacity of 63.42 GiB of which 815.31 MiB is free. Process 3199127 has 55.64 GiB memory in use. Including non-PyTorch memory, this process has 6.98 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 129.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-jmf3ei9y[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-jmf3ei9y/logs[0m
[38;5;196m2025-03-26 01:16:54,898 |         __main__ |    ERROR | CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 2 has a total capacity of 63.42 GiB of which 835.31 MiB is free. Process 3199126 has 55.64 GiB memory in use. Including non-PyTorch memory, this process has 6.96 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 109.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 589, in _init_param_handle_from_module
    _materialize_with_param_init_fn(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 898, in _materialize_with_param_init_fn
    param_init_fn(module)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 70, in <lambda>
    layer.to_empty(device=current_device, recurse=False)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1195, in to_empty
    return self._apply(
           ^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 930, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1196, in <lambda>
    lambda t: torch.empty_like(t, device=device), recurse=recurse
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_prims_common/wrappers.py", line 291, in _fn
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_refs/__init__.py", line 5003, in empty_like
    return torch.empty_permuted(
           ^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 2 has a total capacity of 63.42 GiB of which 835.31 MiB is free. Process 3199126 has 55.64 GiB memory in use. Including non-PyTorch memory, this process has 6.96 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 109.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-kb2rh45u[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-kb2rh45u/logs[0m
[38;5;196m2025-03-26 01:16:54,902 |         __main__ |    ERROR | CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 3 has a total capacity of 63.42 GiB of which 957.31 MiB is free. Process 3199129 has 55.57 GiB memory in use. Including non-PyTorch memory, this process has 6.91 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 129.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 589, in _init_param_handle_from_module
    _materialize_with_param_init_fn(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 898, in _materialize_with_param_init_fn
    param_init_fn(module)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 70, in <lambda>
    layer.to_empty(device=current_device, recurse=False)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1195, in to_empty
    return self._apply(
           ^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 930, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1196, in <lambda>
    lambda t: torch.empty_like(t, device=device), recurse=recurse
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_prims_common/wrappers.py", line 291, in _fn
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_refs/__init__.py", line 5003, in empty_like
    return torch.empty_permuted(
           ^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 3 has a total capacity of 63.42 GiB of which 957.31 MiB is free. Process 3199129 has 55.57 GiB memory in use. Including non-PyTorch memory, this process has 6.91 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 129.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-cm93og29[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-cm93og29/logs[0m
[38;5;196m2025-03-26 01:16:55,029 |         __main__ |    ERROR | CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 1 has a total capacity of 63.42 GiB of which 835.31 MiB is free. Process 29777 has 55.64 GiB memory in use. Including non-PyTorch memory, this process has 6.96 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 109.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 589, in _init_param_handle_from_module
    _materialize_with_param_init_fn(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 898, in _materialize_with_param_init_fn
    param_init_fn(module)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 70, in <lambda>
    layer.to_empty(device=current_device, recurse=False)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1195, in to_empty
    return self._apply(
           ^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 930, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1196, in <lambda>
    lambda t: torch.empty_like(t, device=device), recurse=recurse
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_prims_common/wrappers.py", line 291, in _fn
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_refs/__init__.py", line 5003, in empty_like
    return torch.empty_permuted(
           ^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 1 has a total capacity of 63.42 GiB of which 835.31 MiB is free. Process 29777 has 55.64 GiB memory in use. Including non-PyTorch memory, this process has 6.96 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 109.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:55,032 |         __main__ |    ERROR | CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 3 has a total capacity of 63.42 GiB of which 977.31 MiB is free. Process 29780 has 55.57 GiB memory in use. Including non-PyTorch memory, this process has 6.89 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 109.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 589, in _init_param_handle_from_module
    _materialize_with_param_init_fn(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 898, in _materialize_with_param_init_fn
    param_init_fn(module)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 70, in <lambda>
    layer.to_empty(device=current_device, recurse=False)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1195, in to_empty
    return self._apply(
           ^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 930, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1196, in <lambda>
    lambda t: torch.empty_like(t, device=device), recurse=recurse
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_prims_common/wrappers.py", line 291, in _fn
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_refs/__init__.py", line 5003, in empty_like
    return torch.empty_permuted(
           ^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 3 has a total capacity of 63.42 GiB of which 977.31 MiB is free. Process 29780 has 55.57 GiB memory in use. Including non-PyTorch memory, this process has 6.89 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 109.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-15cud1ki[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-15cud1ki/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-s0up21e2[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-s0up21e2/logs[0m
[38;5;196m2025-03-26 01:16:55,040 |         __main__ |    ERROR | CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 1 has a total capacity of 63.42 GiB of which 615.31 MiB is free. Process 97206 has 55.86 GiB memory in use. Including non-PyTorch memory, this process has 6.96 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 109.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 589, in _init_param_handle_from_module
    _materialize_with_param_init_fn(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 898, in _materialize_with_param_init_fn
    param_init_fn(module)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 70, in <lambda>
    layer.to_empty(device=current_device, recurse=False)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1195, in to_empty
    return self._apply(
           ^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 930, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1196, in <lambda>
    lambda t: torch.empty_like(t, device=device), recurse=recurse
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_prims_common/wrappers.py", line 291, in _fn
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_refs/__init__.py", line 5003, in empty_like
    return torch.empty_permuted(
           ^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 1 has a total capacity of 63.42 GiB of which 615.31 MiB is free. Process 97206 has 55.86 GiB memory in use. Including non-PyTorch memory, this process has 6.96 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 109.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-2gmaorvh[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-2gmaorvh/logs[0m
[38;5;196m2025-03-26 01:16:55,049 |         __main__ |    ERROR | CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 2 has a total capacity of 63.42 GiB of which 755.31 MiB is free. Process 97207 has 55.72 GiB memory in use. Including non-PyTorch memory, this process has 6.96 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 109.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 589, in _init_param_handle_from_module
    _materialize_with_param_init_fn(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 898, in _materialize_with_param_init_fn
    param_init_fn(module)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 70, in <lambda>
    layer.to_empty(device=current_device, recurse=False)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1195, in to_empty
    return self._apply(
           ^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 930, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1196, in <lambda>
    lambda t: torch.empty_like(t, device=device), recurse=recurse
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_prims_common/wrappers.py", line 291, in _fn
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_refs/__init__.py", line 5003, in empty_like
    return torch.empty_permuted(
           ^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 2 has a total capacity of 63.42 GiB of which 755.31 MiB is free. Process 97207 has 55.72 GiB memory in use. Including non-PyTorch memory, this process has 6.96 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 109.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-98qutl7r[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-98qutl7r/logs[0m
[38;5;196m2025-03-26 01:16:55,051 |         __main__ |    ERROR | CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 3 has a total capacity of 63.42 GiB of which 757.31 MiB is free. Process 97204 has 55.79 GiB memory in use. Including non-PyTorch memory, this process has 6.89 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 109.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 589, in _init_param_handle_from_module
    _materialize_with_param_init_fn(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 898, in _materialize_with_param_init_fn
    param_init_fn(module)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 70, in <lambda>
    layer.to_empty(device=current_device, recurse=False)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1195, in to_empty
    return self._apply(
           ^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 930, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1196, in <lambda>
    lambda t: torch.empty_like(t, device=device), recurse=recurse
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_prims_common/wrappers.py", line 291, in _fn
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_refs/__init__.py", line 5003, in empty_like
    return torch.empty_permuted(
           ^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 3 has a total capacity of 63.42 GiB of which 757.31 MiB is free. Process 97204 has 55.79 GiB memory in use. Including non-PyTorch memory, this process has 6.89 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 109.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-sj09ykcn[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-sj09ykcn/logs[0m
[38;5;196m2025-03-26 01:16:55,065 |         __main__ |    ERROR | CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 2 has a total capacity of 63.42 GiB of which 775.31 MiB is free. Process 791400 has 55.74 GiB memory in use. Including non-PyTorch memory, this process has 6.92 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 69.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 589, in _init_param_handle_from_module
    _materialize_with_param_init_fn(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 898, in _materialize_with_param_init_fn
    param_init_fn(module)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 70, in <lambda>
    layer.to_empty(device=current_device, recurse=False)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1195, in to_empty
    return self._apply(
           ^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 930, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1196, in <lambda>
    lambda t: torch.empty_like(t, device=device), recurse=recurse
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_prims_common/wrappers.py", line 291, in _fn
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_refs/__init__.py", line 5003, in empty_like
    return torch.empty_permuted(
           ^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 2 has a total capacity of 63.42 GiB of which 775.31 MiB is free. Process 791400 has 55.74 GiB memory in use. Including non-PyTorch memory, this process has 6.92 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 69.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:55,068 |         __main__ |    ERROR | CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 3 has a total capacity of 63.42 GiB of which 797.31 MiB is free. Process 791399 has 55.67 GiB memory in use. Including non-PyTorch memory, this process has 6.97 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 189.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 589, in _init_param_handle_from_module
    _materialize_with_param_init_fn(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 898, in _materialize_with_param_init_fn
    param_init_fn(module)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 70, in <lambda>
    layer.to_empty(device=current_device, recurse=False)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1195, in to_empty
    return self._apply(
           ^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 930, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1196, in <lambda>
    lambda t: torch.empty_like(t, device=device), recurse=recurse
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_prims_common/wrappers.py", line 291, in _fn
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_refs/__init__.py", line 5003, in empty_like
    return torch.empty_permuted(
           ^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 3 has a total capacity of 63.42 GiB of which 797.31 MiB is free. Process 791399 has 55.67 GiB memory in use. Including non-PyTorch memory, this process has 6.97 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 189.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-58tiob9h[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-58tiob9h/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-3j21rvch[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-3j21rvch/logs[0m
[38;5;196m2025-03-26 01:16:55,072 |         __main__ |    ERROR | CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 1 has a total capacity of 63.42 GiB of which 895.31 MiB is free. Process 791397 has 55.58 GiB memory in use. Including non-PyTorch memory, this process has 6.96 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 109.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 589, in _init_param_handle_from_module
    _materialize_with_param_init_fn(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 898, in _materialize_with_param_init_fn
    param_init_fn(module)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 70, in <lambda>
    layer.to_empty(device=current_device, recurse=False)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1195, in to_empty
    return self._apply(
           ^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 930, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1196, in <lambda>
    lambda t: torch.empty_like(t, device=device), recurse=recurse
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_prims_common/wrappers.py", line 291, in _fn
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_refs/__init__.py", line 5003, in empty_like
    return torch.empty_permuted(
           ^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 1 has a total capacity of 63.42 GiB of which 895.31 MiB is free. Process 791397 has 55.58 GiB memory in use. Including non-PyTorch memory, this process has 6.96 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 109.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-0ld9sdb7[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-0ld9sdb7/logs[0m
[38;5;196m2025-03-26 01:16:55,118 |         __main__ |    ERROR | CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 2 has a total capacity of 63.42 GiB of which 615.31 MiB is free. Process 3543082 has 55.86 GiB memory in use. Including non-PyTorch memory, this process has 6.96 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 109.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 589, in _init_param_handle_from_module
    _materialize_with_param_init_fn(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 898, in _materialize_with_param_init_fn
    param_init_fn(module)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 70, in <lambda>
    layer.to_empty(device=current_device, recurse=False)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1195, in to_empty
    return self._apply(
           ^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 930, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1196, in <lambda>
    lambda t: torch.empty_like(t, device=device), recurse=recurse
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_prims_common/wrappers.py", line 291, in _fn
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_refs/__init__.py", line 5003, in empty_like
    return torch.empty_permuted(
           ^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 2 has a total capacity of 63.42 GiB of which 615.31 MiB is free. Process 3543082 has 55.86 GiB memory in use. Including non-PyTorch memory, this process has 6.96 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 109.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:55,121 |         __main__ |    ERROR | CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 1 has a total capacity of 63.42 GiB of which 615.31 MiB is free. Process 3543079 has 55.86 GiB memory in use. Including non-PyTorch memory, this process has 6.96 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 109.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 589, in _init_param_handle_from_module
    _materialize_with_param_init_fn(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 898, in _materialize_with_param_init_fn
    param_init_fn(module)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 70, in <lambda>
    layer.to_empty(device=current_device, recurse=False)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1195, in to_empty
    return self._apply(
           ^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 930, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1196, in <lambda>
    lambda t: torch.empty_like(t, device=device), recurse=recurse
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_prims_common/wrappers.py", line 291, in _fn
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_refs/__init__.py", line 5003, in empty_like
    return torch.empty_permuted(
           ^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 1 has a total capacity of 63.42 GiB of which 615.31 MiB is free. Process 3543079 has 55.86 GiB memory in use. Including non-PyTorch memory, this process has 6.96 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 109.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-hv8i1l01[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-hv8i1l01/logs[0m
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-xdzbv6df[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-xdzbv6df/logs[0m
[38;5;196m2025-03-26 01:16:55,125 |         __main__ |    ERROR | CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 3 has a total capacity of 63.42 GiB of which 757.31 MiB is free. Process 3543081 has 55.79 GiB memory in use. Including non-PyTorch memory, this process has 6.89 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 109.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 589, in _init_param_handle_from_module
    _materialize_with_param_init_fn(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 898, in _materialize_with_param_init_fn
    param_init_fn(module)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 70, in <lambda>
    layer.to_empty(device=current_device, recurse=False)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1195, in to_empty
    return self._apply(
           ^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 930, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1196, in <lambda>
    lambda t: torch.empty_like(t, device=device), recurse=recurse
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_prims_common/wrappers.py", line 291, in _fn
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/_refs/__init__.py", line 5003, in empty_like
    return torch.empty_permuted(
           ^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 3 has a total capacity of 63.42 GiB of which 757.31 MiB is free. Process 3543081 has 55.79 GiB memory in use. Including non-PyTorch memory, this process has 6.89 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 109.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::native::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461263
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871087
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56871402
#16 at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42780166
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46752622
#18 at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43040679
#19 at::native::empty_permuted_symint(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33732672
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48672879
#21 at::_ops::empty_permuted::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44501778
#22 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46740989
#23 at::_ops::empty_permuted::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44762173
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7069030
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#26 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#27 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#29 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1030395
#31 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#32 _PyObject_Call from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1406721
#33 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:10961702
#34 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14280463
#35 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43602353
#36 at::_ops::empty_like::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:44766507
#37 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:7862404
#38 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#39 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#40 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#41 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#42 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#43 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#45 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#46 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#47 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#48 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#49 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#50 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#51 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#52 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#53 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#54 __libc_start_main from /lib64/libc.so.6:241028
#55 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-gqa6i2if[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-gqa6i2if/logs[0m
[38;5;196m2025-03-26 01:16:55,381 |         __main__ |    ERROR | CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 0 has a total capacity of 63.42 GiB of which 999.31 MiB is free. Process 97205 has 55.61 GiB memory in use. Including non-PyTorch memory, this process has 6.83 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 49.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25448124
#10 at::detail::empty_strided_generic(c10::ArrayRef<long>, c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25420546
#11 at::detail::empty_strided_cuda(c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17076281
#12 at::detail::empty_strided_cuda(c10::ArrayRef<long>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17077902
#13 at::native::empty_strided_cuda(c10::ArrayRef<long>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461417
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56874392
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56874831
#16 at::_ops::empty_strided::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42779266
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46741165
#18 at::_ops::empty_strided::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43050704
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:29499750
#20 at::native::_to_copy(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33490373
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48687962
#22 at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39062580
#23 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46753730
#24 at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39062580
#25 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80536254
#26 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80537341
#27 at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39619970
#28 at::native::to(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33471340
#29 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:50873280
#30 at::_ops::to_dtype_layout::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:41422167
#31 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:6060298
#32 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:6510740
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1458669
#34 PyObject_Vectorcall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408706
#35 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#36 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#37 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#38 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#39 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#40 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#41 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#42 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#43 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#45 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#46 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#47 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#48 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#49 __libc_start_main from /lib64/libc.so.6:241028
#50 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 612, in _init_param_handle_from_module
    _move_module_to_device(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1005, in _move_module_to_device
    _move_states_to_device(params_to_move, bufs_to_move, device_from_device_id)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1035, in _move_states_to_device
    param.data = param.to(device_from_device_id)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 0 has a total capacity of 63.42 GiB of which 999.31 MiB is free. Process 97205 has 55.61 GiB memory in use. Including non-PyTorch memory, this process has 6.83 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 49.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25448124
#10 at::detail::empty_strided_generic(c10::ArrayRef<long>, c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25420546
#11 at::detail::empty_strided_cuda(c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17076281
#12 at::detail::empty_strided_cuda(c10::ArrayRef<long>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17077902
#13 at::native::empty_strided_cuda(c10::ArrayRef<long>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461417
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56874392
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56874831
#16 at::_ops::empty_strided::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42779266
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46741165
#18 at::_ops::empty_strided::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43050704
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:29499750
#20 at::native::_to_copy(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33490373
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48687962
#22 at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39062580
#23 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46753730
#24 at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39062580
#25 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80536254
#26 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80537341
#27 at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39619970
#28 at::native::to(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33471340
#29 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:50873280
#30 at::_ops::to_dtype_layout::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:41422167
#31 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:6060298
#32 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:6510740
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1458669
#34 PyObject_Vectorcall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408706
#35 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#36 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#37 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#38 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#39 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#40 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#41 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#42 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#43 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#45 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#46 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#47 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#48 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#49 __libc_start_main from /lib64/libc.so.6:241028
#50 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:55,407 |         __main__ |    ERROR | CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 0 has a total capacity of 63.42 GiB of which 999.31 MiB is free. Process 791398 has 55.51 GiB memory in use. Including non-PyTorch memory, this process has 6.93 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 149.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25448124
#10 at::detail::empty_strided_generic(c10::ArrayRef<long>, c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25420546
#11 at::detail::empty_strided_cuda(c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17076281
#12 at::detail::empty_strided_cuda(c10::ArrayRef<long>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17077902
#13 at::native::empty_strided_cuda(c10::ArrayRef<long>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461417
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56874392
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56874831
#16 at::_ops::empty_strided::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42779266
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46741165
#18 at::_ops::empty_strided::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43050704
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:29499750
#20 at::native::_to_copy(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33490373
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48687962
#22 at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39062580
#23 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46753730
#24 at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39062580
#25 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80536254
#26 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80537341
#27 at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39619970
#28 at::native::to(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33471340
#29 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:50873280
#30 at::_ops::to_dtype_layout::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:41422167
#31 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:6060298
#32 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:6510740
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1458669
#34 PyObject_Vectorcall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408706
#35 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#36 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#37 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#38 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#39 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#40 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#41 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#42 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#43 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#45 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#46 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#47 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#48 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#49 __libc_start_main from /lib64/libc.so.6:241028
#50 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 612, in _init_param_handle_from_module
    _move_module_to_device(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1005, in _move_module_to_device
    _move_states_to_device(params_to_move, bufs_to_move, device_from_device_id)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1035, in _move_states_to_device
    param.data = param.to(device_from_device_id)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 0 has a total capacity of 63.42 GiB of which 999.31 MiB is free. Process 791398 has 55.51 GiB memory in use. Including non-PyTorch memory, this process has 6.93 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 149.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25448124
#10 at::detail::empty_strided_generic(c10::ArrayRef<long>, c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25420546
#11 at::detail::empty_strided_cuda(c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17076281
#12 at::detail::empty_strided_cuda(c10::ArrayRef<long>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17077902
#13 at::native::empty_strided_cuda(c10::ArrayRef<long>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461417
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56874392
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56874831
#16 at::_ops::empty_strided::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42779266
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46741165
#18 at::_ops::empty_strided::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43050704
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:29499750
#20 at::native::_to_copy(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33490373
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48687962
#22 at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39062580
#23 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46753730
#24 at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39062580
#25 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80536254
#26 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80537341
#27 at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39619970
#28 at::native::to(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33471340
#29 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:50873280
#30 at::_ops::to_dtype_layout::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:41422167
#31 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:6060298
#32 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:6510740
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1458669
#34 PyObject_Vectorcall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408706
#35 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#36 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#37 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#38 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#39 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#40 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#41 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#42 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#43 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#45 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#46 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#47 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#48 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#49 __libc_start_main from /lib64/libc.so.6:241028
#50 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:55,452 |         __main__ |    ERROR | CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 0 has a total capacity of 63.42 GiB of which 879.31 MiB is free. Process 3543080 has 55.61 GiB memory in use. Including non-PyTorch memory, this process has 6.95 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 169.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25448124
#10 at::detail::empty_strided_generic(c10::ArrayRef<long>, c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25420546
#11 at::detail::empty_strided_cuda(c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17076281
#12 at::detail::empty_strided_cuda(c10::ArrayRef<long>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17077902
#13 at::native::empty_strided_cuda(c10::ArrayRef<long>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461417
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56874392
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56874831
#16 at::_ops::empty_strided::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42779266
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46741165
#18 at::_ops::empty_strided::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43050704
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:29499750
#20 at::native::_to_copy(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33490373
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48687962
#22 at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39062580
#23 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46753730
#24 at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39062580
#25 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80536254
#26 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80537341
#27 at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39619970
#28 at::native::to(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33471340
#29 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:50873280
#30 at::_ops::to_dtype_layout::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:41422167
#31 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:6060298
#32 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:6510740
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1458669
#34 PyObject_Vectorcall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408706
#35 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#36 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#37 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#38 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#39 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#40 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#41 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#42 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#43 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#45 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#46 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#47 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#48 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#49 __libc_start_main from /lib64/libc.so.6:241028
#50 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 612, in _init_param_handle_from_module
    _move_module_to_device(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1005, in _move_module_to_device
    _move_states_to_device(params_to_move, bufs_to_move, device_from_device_id)
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1035, in _move_states_to_device
    param.data = param.to(device_from_device_id)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 1002.00 MiB. GPU 0 has a total capacity of 63.42 GiB of which 879.31 MiB is free. Process 3543080 has 55.61 GiB memory in use. Including non-PyTorch memory, this process has 6.95 GiB memory in use. Of the allocated memory 4.23 GiB is allocated by PyTorch, and 169.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25448124
#10 at::detail::empty_strided_generic(c10::ArrayRef<long>, c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25420546
#11 at::detail::empty_strided_cuda(c10::ArrayRef<long>, c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17076281
#12 at::detail::empty_strided_cuda(c10::ArrayRef<long>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17077902
#13 at::native::empty_strided_cuda(c10::ArrayRef<long>, c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:19461417
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56874392
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56874831
#16 at::_ops::empty_strided::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:42779266
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46741165
#18 at::_ops::empty_strided::call(c10::ArrayRef<c10::SymInt>, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:43050704
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:29499750
#20 at::native::_to_copy(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33490373
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:48687962
#22 at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39062580
#23 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:46753730
#24 at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39062580
#25 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80536254
#26 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80537341
#27 at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39619970
#28 at::native::to(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33471340
#29 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:50873280
#30 at::_ops::to_dtype_layout::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:41422167
#31 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:6060298
#32 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:6510740
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1458669
#34 PyObject_Vectorcall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408706
#35 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#36 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#37 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#38 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#39 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#40 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#41 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#42 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#43 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#44 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#45 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#46 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#47 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#48 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#49 __libc_start_main from /lib64/libc.so.6:241028
#50 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-luwp46d2[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-luwp46d2/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-wi62geqq[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-wi62geqq/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-amvnrk85[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-amvnrk85/logs[0m
[38;5;196m2025-03-26 01:16:55,583 |         __main__ |    ERROR | ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.4.0.31]:63118
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.4.0.31]:63118
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:55,583 |         __main__ |    ERROR | ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.4.0.31]:19107
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.4.0.31]:19107
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:55,583 |         __main__ |    ERROR | ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.4.0.31]:34976
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.4.0.31]:34976
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-n3awtcc7[0m
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-r6q4q8nk[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-vwvv8vyu[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-n3awtcc7/logs[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-r6q4q8nk/logs[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-vwvv8vyu/logs[0m
[38;5;196m2025-03-26 01:16:55,614 |         __main__ |    ERROR | ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.212]:64136
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.212]:64136
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:55,613 |         __main__ |    ERROR | ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.212]:30441
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.212]:30441
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:55,613 |         __main__ |    ERROR | ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.212]:38124
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.212]:38124
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-lqlj570w[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-lqlj570w/logs[0m
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-3tegnpi2[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-3tegnpi2/logs[0m
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-e4mfx669[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-e4mfx669/logs[0m
[38;5;196m2025-03-26 01:16:55,757 |         __main__ |    ERROR | ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.211]:35495
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.211]:35495
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:55,757 |         __main__ |    ERROR | ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.211]:60079
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.211]:60079
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-2503gb0r[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-2503gb0r/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-op9vzhnm[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-op9vzhnm/logs[0m
[38;5;196m2025-03-26 01:16:55,776 |         __main__ |    ERROR | ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.211]:20139
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.211]:20139
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:55,776 |         __main__ |    ERROR | ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.211]:28809
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.211]:28809
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:55,776 |         __main__ |    ERROR | ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.211]:53955
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.211]:53955
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:55,776 |         __main__ |    ERROR | ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.211]:36552
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.211]:36552
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-frzt8gsv[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-frzt8gsv/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-jflgiqko[0m
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-6gdd3i7a[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-jflgiqko/logs[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-6gdd3i7a/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-aypuqulu[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-aypuqulu/logs[0m
[38;5;196m2025-03-26 01:16:55,782 |         __main__ |    ERROR | [Rank 0]: Ranks 1, 2, 3 failed to pass monitoredBarrier in 60000 ms
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103657579
#9 c10d::ProcessGroupGloo::monitoredBarrier(c10d::BarrierOptions const&, bool) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103682775
#10 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#11 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#19 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#23 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#24 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#26 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#27 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#34 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#35 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#36 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#37 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#38 __libc_start_main from /lib64/libc.so.6:241028
#39 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 629, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: [Rank 0]: Ranks 1, 2, 3 failed to pass monitoredBarrier in 60000 ms
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103657579
#9 c10d::ProcessGroupGloo::monitoredBarrier(c10d::BarrierOptions const&, bool) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103682775
#10 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#11 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#19 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#23 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#24 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#26 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#27 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#34 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#35 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#36 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#37 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#38 __libc_start_main from /lib64/libc.so.6:241028
#39 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-x9jsapfo[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-x9jsapfo/logs[0m
[38;5;196m2025-03-26 01:16:55,721 |         __main__ |    ERROR | CUDA out of memory. Tried to allocate 1004.00 MiB. GPU 2 has a total capacity of 63.42 GiB of which 53.31 MiB is free. Process 3763106 has 55.43 GiB memory in use. Including non-PyTorch memory, this process has 7.94 GiB memory in use. Of the allocated memory 5.21 GiB is allocated by PyTorch, and 109.87 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::detail::empty_cuda(c10::ArrayRef<long>, c10::TensorOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075943
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56857962
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:58064504
#16 at::meta::structured_cat::meta(c10::IListRef<at::Tensor> const&, long) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33783727
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:57628543
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:57628703
#19 at::_ops::cat::redispatch(c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39102151
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80572264
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80576706
#22 at::_ops::cat::call(c10::IListRef<at::Tensor> const&, long) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39372439
#23 at::native::flatten_dense_tensors(c10::ArrayRef<at::Tensor>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33882667
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:50886431
#25 at::_ops::flatten_dense_tensors::call(c10::ArrayRef<at::Tensor>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:41629262
#26 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963803
#27 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#28 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#33 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#34 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#35 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#36 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#37 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#38 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#39 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#40 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#41 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#42 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#43 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#44 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#45 __libc_start_main from /lib64/libc.so.6:241028
#46 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 629, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 1004.00 MiB. GPU 2 has a total capacity of 63.42 GiB of which 53.31 MiB is free. Process 3763106 has 55.43 GiB memory in use. Including non-PyTorch memory, this process has 7.94 GiB memory in use. Of the allocated memory 5.21 GiB is allocated by PyTorch, and 109.87 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::detail::empty_cuda(c10::ArrayRef<long>, c10::TensorOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075943
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56857962
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:58064504
#16 at::meta::structured_cat::meta(c10::IListRef<at::Tensor> const&, long) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33783727
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:57628543
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:57628703
#19 at::_ops::cat::redispatch(c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39102151
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80572264
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80576706
#22 at::_ops::cat::call(c10::IListRef<at::Tensor> const&, long) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39372439
#23 at::native::flatten_dense_tensors(c10::ArrayRef<at::Tensor>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33882667
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:50886431
#25 at::_ops::flatten_dense_tensors::call(c10::ArrayRef<at::Tensor>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:41629262
#26 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963803
#27 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#28 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#33 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#34 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#35 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#36 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#37 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#38 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#39 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#40 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#41 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#42 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#43 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#44 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#45 __libc_start_main from /lib64/libc.so.6:241028
#46 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-e1q1a40d[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-e1q1a40d/logs[0m
[38;5;196m2025-03-26 01:16:55,789 |         __main__ |    ERROR | ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.47]:56521
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.47]:56521
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:55,789 |         __main__ |    ERROR | ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.47]:35536
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.47]:35536
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:55,789 |         __main__ |    ERROR | ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.47]:15560
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.47]:15560
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:55,789 |         __main__ |    ERROR | ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.47]:23737
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.47]:23737
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:55,727 |         __main__ |    ERROR | CUDA out of memory. Tried to allocate 1004.00 MiB. GPU 1 has a total capacity of 63.42 GiB of which 53.31 MiB is free. Process 3763107 has 55.43 GiB memory in use. Including non-PyTorch memory, this process has 7.94 GiB memory in use. Of the allocated memory 5.21 GiB is allocated by PyTorch, and 109.87 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::detail::empty_cuda(c10::ArrayRef<long>, c10::TensorOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075943
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56857962
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:58064504
#16 at::meta::structured_cat::meta(c10::IListRef<at::Tensor> const&, long) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33783727
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:57628543
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:57628703
#19 at::_ops::cat::redispatch(c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39102151
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80572264
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80576706
#22 at::_ops::cat::call(c10::IListRef<at::Tensor> const&, long) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39372439
#23 at::native::flatten_dense_tensors(c10::ArrayRef<at::Tensor>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33882667
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:50886431
#25 at::_ops::flatten_dense_tensors::call(c10::ArrayRef<at::Tensor>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:41629262
#26 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963803
#27 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#28 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#33 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#34 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#35 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#36 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#37 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#38 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#39 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#40 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#41 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#42 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#43 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#44 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#45 __libc_start_main from /lib64/libc.so.6:241028
#46 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 629, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 1004.00 MiB. GPU 1 has a total capacity of 63.42 GiB of which 53.31 MiB is free. Process 3763107 has 55.43 GiB memory in use. Including non-PyTorch memory, this process has 7.94 GiB memory in use. Of the allocated memory 5.21 GiB is allocated by PyTorch, and 109.87 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::detail::empty_cuda(c10::ArrayRef<long>, c10::TensorOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075943
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56857962
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:58064504
#16 at::meta::structured_cat::meta(c10::IListRef<at::Tensor> const&, long) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33783727
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:57628543
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:57628703
#19 at::_ops::cat::redispatch(c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39102151
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80572264
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80576706
#22 at::_ops::cat::call(c10::IListRef<at::Tensor> const&, long) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39372439
#23 at::native::flatten_dense_tensors(c10::ArrayRef<at::Tensor>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33882667
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:50886431
#25 at::_ops::flatten_dense_tensors::call(c10::ArrayRef<at::Tensor>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:41629262
#26 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963803
#27 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#28 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#33 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#34 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#35 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#36 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#37 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#38 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#39 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#40 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#41 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#42 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#43 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#44 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#45 __libc_start_main from /lib64/libc.so.6:241028
#46 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-qm7dv7nc[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-73ugho0t[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-qm7dv7nc/logs[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-73ugho0t/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-232q16h9[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-232q16h9/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-rdeu16fj[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-rdeu16fj/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-4t6vd6u6[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-4t6vd6u6/logs[0m
[38;5;196m2025-03-26 01:16:55,732 |         __main__ |    ERROR | CUDA out of memory. Tried to allocate 1004.00 MiB. GPU 3 has a total capacity of 63.42 GiB of which 195.31 MiB is free. Process 3763109 has 55.36 GiB memory in use. Including non-PyTorch memory, this process has 7.87 GiB memory in use. Of the allocated memory 5.21 GiB is allocated by PyTorch, and 109.87 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::detail::empty_cuda(c10::ArrayRef<long>, c10::TensorOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075943
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56857962
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:58064504
#16 at::meta::structured_cat::meta(c10::IListRef<at::Tensor> const&, long) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33783727
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:57628543
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:57628703
#19 at::_ops::cat::redispatch(c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39102151
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80572264
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80576706
#22 at::_ops::cat::call(c10::IListRef<at::Tensor> const&, long) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39372439
#23 at::native::flatten_dense_tensors(c10::ArrayRef<at::Tensor>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33882667
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:50886431
#25 at::_ops::flatten_dense_tensors::call(c10::ArrayRef<at::Tensor>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:41629262
#26 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963803
#27 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#28 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#33 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#34 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#35 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#36 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#37 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#38 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#39 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#40 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#41 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#42 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#43 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#44 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#45 __libc_start_main from /lib64/libc.so.6:241028
#46 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 629, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 1004.00 MiB. GPU 3 has a total capacity of 63.42 GiB of which 195.31 MiB is free. Process 3763109 has 55.36 GiB memory in use. Including non-PyTorch memory, this process has 7.87 GiB memory in use. Of the allocated memory 5.21 GiB is allocated by PyTorch, and 109.87 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::detail::empty_cuda(c10::ArrayRef<long>, c10::TensorOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075943
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56857962
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:58064504
#16 at::meta::structured_cat::meta(c10::IListRef<at::Tensor> const&, long) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33783727
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:57628543
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:57628703
#19 at::_ops::cat::redispatch(c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39102151
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80572264
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80576706
#22 at::_ops::cat::call(c10::IListRef<at::Tensor> const&, long) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39372439
#23 at::native::flatten_dense_tensors(c10::ArrayRef<at::Tensor>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33882667
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:50886431
#25 at::_ops::flatten_dense_tensors::call(c10::ArrayRef<at::Tensor>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:41629262
#26 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963803
#27 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#28 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#33 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#34 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#35 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#36 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#37 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#38 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#39 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#40 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#41 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#42 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#43 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#44 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#45 __libc_start_main from /lib64/libc.so.6:241028
#46 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-j6l1dtwi[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-j6l1dtwi/logs[0m
[38;5;196m2025-03-26 01:16:55,735 |         __main__ |    ERROR | CUDA out of memory. Tried to allocate 1004.00 MiB. GPU 0 has a total capacity of 63.42 GiB of which 337.31 MiB is free. Process 3763108 has 55.14 GiB memory in use. Including non-PyTorch memory, this process has 7.95 GiB memory in use. Of the allocated memory 5.21 GiB is allocated by PyTorch, and 189.87 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::detail::empty_cuda(c10::ArrayRef<long>, c10::TensorOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075943
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56857962
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:58064504
#16 at::meta::structured_cat::meta(c10::IListRef<at::Tensor> const&, long) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33783727
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:57628543
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:57628703
#19 at::_ops::cat::redispatch(c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39102151
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80572264
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80576706
#22 at::_ops::cat::call(c10::IListRef<at::Tensor> const&, long) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39372439
#23 at::native::flatten_dense_tensors(c10::ArrayRef<at::Tensor>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33882667
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:50886431
#25 at::_ops::flatten_dense_tensors::call(c10::ArrayRef<at::Tensor>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:41629262
#26 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963803
#27 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#28 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#33 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#34 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#35 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#36 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#37 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#38 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#39 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#40 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#41 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#42 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#43 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#44 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#45 __libc_start_main from /lib64/libc.so.6:241028
#46 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 629, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 1004.00 MiB. GPU 0 has a total capacity of 63.42 GiB of which 337.31 MiB is free. Process 3763108 has 55.14 GiB memory in use. Including non-PyTorch memory, this process has 7.95 GiB memory in use. Of the allocated memory 5.21 GiB is allocated by PyTorch, and 189.87 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception raised from malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:1338 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:252251
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:253190
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10_cuda.so:254542
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25440248
#10 at::detail::empty_generic(c10::ArrayRef<long>, c10::Allocator*, c10::DispatchKeySet, c10::ScalarType, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:25419443
#11 at::detail::empty_cuda(c10::ArrayRef<long>, c10::ScalarType, std::optional<c10::Device>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17074061
#12 at::detail::empty_cuda(c10::ArrayRef<long>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075652
#13 at::detail::empty_cuda(c10::ArrayRef<long>, c10::TensorOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:17075943
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:56857962
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:58064504
#16 at::meta::structured_cat::meta(c10::IListRef<at::Tensor> const&, long) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33783727
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:57628543
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cuda.so:57628703
#19 at::_ops::cat::redispatch(c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39102151
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80572264
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:80576706
#22 at::_ops::cat::call(c10::IListRef<at::Tensor> const&, long) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:39372439
#23 at::native::flatten_dense_tensors(c10::ArrayRef<at::Tensor>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:33882667
#24 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:50886431
#25 at::_ops::flatten_dense_tensors::call(c10::ArrayRef<at::Tensor>) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:41629262
#26 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963803
#27 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#28 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#33 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#34 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#35 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#36 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#37 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#38 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#39 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#40 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#41 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#42 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#43 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#44 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#45 __libc_start_main from /lib64/libc.so.6:241028
#46 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-ptij1bv2[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-ptij1bv2/logs[0m
[38;5;196m2025-03-26 01:16:55,846 |         __main__ |    ERROR | ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.31]:59564
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.31]:59564
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:55,847 |         __main__ |    ERROR | ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.31]:39564
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.31]:39564
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:55,846 |         __main__ |    ERROR | ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.31]:27354
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.31]:27354
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:55,846 |         __main__ |    ERROR | ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.31]:23714
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: ProcessGroupWrapper: Monitored Barrier encountered error running collective: CollectiveFingerPrint(SequenceNumber=64, OpType=BROADCAST, TensorShape=[525336576], TensorDtypes=BFloat16, TensorDeviceTypes=TensorOptions(dtype=float (default), device=cuda, layout=Strided (default), requires_grad=false (default), pinned_memory=false (default), memory_format=(nullopt))). Error: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.31]:23714
Exception raised from runCollectiveChecks at /pytorch/torch/csrc/distributed/c10d/ProcessGroupWrapper.cpp:600 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23113568
#8 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#9 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#10 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#16 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#19 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#20 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#21 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#23 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#24 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#26 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#27 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#28 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#29 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#30 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#31 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#32 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#33 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#34 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#35 __libc_start_main from /lib64/libc.so.6:241028
#36 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-716jo0hk[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-716jo0hk/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-0zhtg9ft[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-0zhtg9ft/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-zo6hyxgy[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-zo6hyxgy/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-zhx3bz9x[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-zhx3bz9x/logs[0m
[38;5;196m2025-03-26 01:16:55,818 |         __main__ |    ERROR | [Rank 0]: Ranks 1, 2, 3 failed to pass monitoredBarrier in 60000 ms
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103657579
#9 c10d::ProcessGroupGloo::monitoredBarrier(c10d::BarrierOptions const&, bool) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103682775
#10 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#11 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#19 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#23 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#24 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#26 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#27 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#34 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#35 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#36 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#37 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#38 __libc_start_main from /lib64/libc.so.6:241028
#39 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 629, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: [Rank 0]: Ranks 1, 2, 3 failed to pass monitoredBarrier in 60000 ms
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103657579
#9 c10d::ProcessGroupGloo::monitoredBarrier(c10d::BarrierOptions const&, bool) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103682775
#10 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#11 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#19 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#23 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#24 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#26 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#27 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#34 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#35 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#36 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#37 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#38 __libc_start_main from /lib64/libc.so.6:241028
#39 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-i8sdkzqf[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-i8sdkzqf/logs[0m
[38;5;196m2025-03-26 01:16:55,886 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.4.0.4]:18852: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.4.0.4]:18852: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-a8soh1y9[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-a8soh1y9/logs[0m
[38;5;196m2025-03-26 01:16:55,896 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.4.0.4]:18852: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.4.0.4]:18852: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-qfxlsvnb[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-qfxlsvnb/logs[0m
[38;5;196m2025-03-26 01:16:55,917 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.4.0.4]:25486: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.4.0.4]:25486: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-7r7ptigu[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-7r7ptigu/logs[0m
[38;5;196m2025-03-26 01:16:55,920 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.4.0.4]:51120: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.4.0.4]:51120: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-l6qiidvq[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-l6qiidvq/logs[0m
[38;5;196m2025-03-26 01:16:55,924 |         __main__ |    ERROR | [Rank 0]: Ranks 1, 3 failed to pass monitoredBarrier in 60000 ms
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103657579
#9 c10d::ProcessGroupGloo::monitoredBarrier(c10d::BarrierOptions const&, bool) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103682775
#10 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#11 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#19 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#23 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#24 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#26 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#27 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#34 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#35 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#36 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#37 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#38 __libc_start_main from /lib64/libc.so.6:241028
#39 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 629, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: [Rank 0]: Ranks 1, 3 failed to pass monitoredBarrier in 60000 ms
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103657579
#9 c10d::ProcessGroupGloo::monitoredBarrier(c10d::BarrierOptions const&, bool) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103682775
#10 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#11 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#19 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#23 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#24 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#26 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#27 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#34 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#35 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#36 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#37 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#38 __libc_start_main from /lib64/libc.so.6:241028
#39 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-f06e9am0[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-f06e9am0/logs[0m
[38;5;196m2025-03-26 01:16:55,927 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.4.0.4]:25486: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.4.0.4]:25486: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-t4gbp5dr[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-t4gbp5dr/logs[0m
[38;5;196m2025-03-26 01:16:55,931 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.4.0.4]:51120: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.4.0.4]:51120: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-rahv905o[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-rahv905o/logs[0m
[38;5;196m2025-03-26 01:16:55,928 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.3.0.181]:56714: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.3.0.181]:56714: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-19hwnvyt[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-19hwnvyt/logs[0m
[38;5;196m2025-03-26 01:16:55,938 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.181]:56714
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.181]:56714
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-jbin7uhs[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-jbin7uhs/logs[0m
[38;5;196m2025-03-26 01:16:55,947 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.3.0.181]:11182: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.3.0.181]:11182: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-te12gggi[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-te12gggi/logs[0m
[38;5;196m2025-03-26 01:16:55,957 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.3.0.181]:11182: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.3.0.181]:11182: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:55,959 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.3.0.181]:51121: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.3.0.181]:51121: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-98kk44bz[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-98kk44bz/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-c80bn5h0[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-c80bn5h0/logs[0m
[38;5;196m2025-03-26 01:16:55,969 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.181]:51121
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.181]:51121
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-4xoussxr[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-4xoussxr/logs[0m
[38;5;196m2025-03-26 01:16:56,061 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.182]:56195
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.182]:56195
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-xb0lvo8n[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-xb0lvo8n/logs[0m
[38;5;196m2025-03-26 01:16:56,070 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.2.0.182]:40334: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.2.0.182]:40334: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-rzn983ji[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-rzn983ji/logs[0m
[38;5;196m2025-03-26 01:16:56,071 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.182]:56195
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.182]:56195
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-afjbobhb[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-afjbobhb/logs[0m
[38;5;196m2025-03-26 01:16:56,080 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.182]:40334
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.182]:40334
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-6l847sal[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-6l847sal/logs[0m
[38;5;196m2025-03-26 01:16:56,099 |         __main__ |    ERROR | [Rank 0]: Ranks 3 failed to pass monitoredBarrier in 60000 ms
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103657579
#9 c10d::ProcessGroupGloo::monitoredBarrier(c10d::BarrierOptions const&, bool) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103682775
#10 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#11 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#19 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#23 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#24 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#26 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#27 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#34 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#35 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#36 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#37 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#38 __libc_start_main from /lib64/libc.so.6:241028
#39 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: [Rank 0]: Ranks 3 failed to pass monitoredBarrier in 60000 ms
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103657579
#9 c10d::ProcessGroupGloo::monitoredBarrier(c10d::BarrierOptions const&, bool) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103682775
#10 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#11 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#19 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#23 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#24 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#26 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#27 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#34 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#35 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#36 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#37 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#38 __libc_start_main from /lib64/libc.so.6:241028
#39 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-ii5fkxzr[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-ii5fkxzr/logs[0m
[38;5;196m2025-03-26 01:16:56,110 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.182]:39325
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.182]:39325
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-3ok1zt7a[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-3ok1zt7a/logs[0m
[38;5;196m2025-03-26 01:16:56,120 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.182]:63894
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.182]:63894
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:56,120 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.182]:18842
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.182]:18842
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:56,120 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.182]:39822
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.182]:39822
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-kmgh69h2[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-kmgh69h2/logs[0m
[38;5;196m2025-03-26 01:16:56,120 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.182]:39325
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.182]:39325
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-umktv7ig[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-umktv7ig/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-99ugwhtu[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-99ugwhtu/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-d28xs2ea[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-d28xs2ea/logs[0m
[38;5;196m2025-03-26 01:16:56,127 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.1]:3493
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.1]:3493
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:56,130 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.182]:63894
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.182]:63894
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-nwyzmsx6[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-nwyzmsx6/logs[0m
[38;5;196m2025-03-26 01:16:56,130 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.182]:18842
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.182]:18842
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:56,130 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.182]:39822
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.182]:39822
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-lefpxfm9[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-lefpxfm9/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-9vov3gua[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-yhrssmhm[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-yhrssmhm/logs[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-9vov3gua/logs[0m
[38;5;196m2025-03-26 01:16:56,071 |         __main__ |    ERROR | [Rank 0]: Ranks 3 failed to pass monitoredBarrier in 60000 ms
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103657579
#9 c10d::ProcessGroupGloo::monitoredBarrier(c10d::BarrierOptions const&, bool) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103682775
#10 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#11 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#19 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#23 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#24 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#26 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#27 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#34 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#35 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#36 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#37 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#38 __libc_start_main from /lib64/libc.so.6:241028
#39 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: [Rank 0]: Ranks 3 failed to pass monitoredBarrier in 60000 ms
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103657579
#9 c10d::ProcessGroupGloo::monitoredBarrier(c10d::BarrierOptions const&, bool) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103682775
#10 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#11 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#19 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#23 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#24 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#26 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#27 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#34 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#35 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#36 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#37 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#38 __libc_start_main from /lib64/libc.so.6:241028
#39 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:56,072 |         __main__ |    ERROR | [Rank 0]: Ranks 3 failed to pass monitoredBarrier in 60000 ms
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103657579
#9 c10d::ProcessGroupGloo::monitoredBarrier(c10d::BarrierOptions const&, bool) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103682775
#10 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#11 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#19 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#23 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#24 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#26 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#27 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#34 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#35 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#36 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#37 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#38 __libc_start_main from /lib64/libc.so.6:241028
#39 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: [Rank 0]: Ranks 3 failed to pass monitoredBarrier in 60000 ms
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103657579
#9 c10d::ProcessGroupGloo::monitoredBarrier(c10d::BarrierOptions const&, bool) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103682775
#10 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#11 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#19 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#23 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#24 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#26 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#27 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#34 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#35 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#36 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#37 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#38 __libc_start_main from /lib64/libc.so.6:241028
#39 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:56,071 |         __main__ |    ERROR | [Rank 0]: Ranks 3 failed to pass monitoredBarrier in 60000 ms
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103657579
#9 c10d::ProcessGroupGloo::monitoredBarrier(c10d::BarrierOptions const&, bool) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103682775
#10 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#11 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#19 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#23 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#24 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#26 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#27 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#34 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#35 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#36 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#37 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#38 __libc_start_main from /lib64/libc.so.6:241028
#39 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: [Rank 0]: Ranks 3 failed to pass monitoredBarrier in 60000 ms
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103657579
#9 c10d::ProcessGroupGloo::monitoredBarrier(c10d::BarrierOptions const&, bool) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103682775
#10 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#11 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#19 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#23 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#24 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#26 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#27 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#34 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#35 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#36 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#37 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#38 __libc_start_main from /lib64/libc.so.6:241028
#39 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:56,137 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.1.0.1]:11187: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.1.0.1]:11187: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-ucjk19kz[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-ucjk19kz/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-pbz04hy6[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-pbz04hy6/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-zldfaeq4[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-zldfaeq4/logs[0m
[38;5;196m2025-03-26 01:16:56,137 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.1.0.1]:3493: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.1.0.1]:3493: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-kczigqcg[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-kczigqcg/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-e38w27po[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-e38w27po/logs[0m
[38;5;196m2025-03-26 01:16:56,143 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.1]:35728
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.1]:35728
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:56,143 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.1]:28574
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.1]:28574
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-l0ar7x5d[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-l0ar7x5d/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-1nvkyiiq[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-1nvkyiiq/logs[0m
[38;5;196m2025-03-26 01:16:56,081 |         __main__ |    ERROR | [Rank 0]: Ranks 3 failed to pass monitoredBarrier in 60000 ms
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103657579
#9 c10d::ProcessGroupGloo::monitoredBarrier(c10d::BarrierOptions const&, bool) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103682775
#10 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#11 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#19 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#23 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#24 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#26 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#27 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#34 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#35 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#36 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#37 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#38 __libc_start_main from /lib64/libc.so.6:241028
#39 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: [Rank 0]: Ranks 3 failed to pass monitoredBarrier in 60000 ms
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103657579
#9 c10d::ProcessGroupGloo::monitoredBarrier(c10d::BarrierOptions const&, bool) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103682775
#10 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#11 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#19 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#23 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#24 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#26 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#27 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#34 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#35 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#36 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#37 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#38 __libc_start_main from /lib64/libc.so.6:241028
#39 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-esznpvoj[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-esznpvoj/logs[0m
[38;5;196m2025-03-26 01:16:56,147 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.1.0.1]:11187: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.1.0.1]:11187: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-3kyzuk8c[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-3kyzuk8c/logs[0m
[38;5;196m2025-03-26 01:16:56,152 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.1]:35728
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.1]:35728
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:56,153 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.1]:28574
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.1.0.1]:28574
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-k4keud6e[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-k4keud6e/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-6kqa41jk[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-6kqa41jk/logs[0m
[38;5;196m2025-03-26 01:16:56,177 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.2.0.1]:48534: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.2.0.1]:48534: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:56,178 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.2.0.1]:41897: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.2.0.1]:41897: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-szslyt2s[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-esd8qd33[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-szslyt2s/logs[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-esd8qd33/logs[0m
[38;5;196m2025-03-26 01:16:56,184 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.2.0.1]:62849: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.2.0.1]:62849: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-6n79vcn2[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-6n79vcn2/logs[0m
[38;5;196m2025-03-26 01:16:56,187 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.2.0.1]:48534: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.2.0.1]:48534: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:56,189 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.2.0.1]:41897: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.2.0.1]:41897: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-dfnhwmlo[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-dfnhwmlo/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-o8oczvni[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-o8oczvni/logs[0m
[38;5;196m2025-03-26 01:16:56,191 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.2.0.1]:7074: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.2.0.1]:7074: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:56,129 |         __main__ |    ERROR | [Rank 0]: Ranks 3 failed to pass monitoredBarrier in 60000 ms
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103657579
#9 c10d::ProcessGroupGloo::monitoredBarrier(c10d::BarrierOptions const&, bool) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103682775
#10 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#11 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#19 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#23 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#24 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#26 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#27 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#34 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#35 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#36 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#37 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#38 __libc_start_main from /lib64/libc.so.6:241028
#39 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: [Rank 0]: Ranks 3 failed to pass monitoredBarrier in 60000 ms
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103657579
#9 c10d::ProcessGroupGloo::monitoredBarrier(c10d::BarrierOptions const&, bool) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103682775
#10 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#11 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#19 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#23 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#24 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#26 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#27 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#34 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#35 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#36 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#37 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#38 __libc_start_main from /lib64/libc.so.6:241028
#39 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-ih6u654n[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-ih6u654n/logs[0m
[38;5;196m2025-03-26 01:16:56,193 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.2.0.1]:62849: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:525] Read error [10.2.0.1]:62849: Connection reset by peer
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-nalh60y2[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-nalh60y2/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-0y7i6nif[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-0y7i6nif/logs[0m
[38;5;196m2025-03-26 01:16:56,201 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.1]:7074
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.1]:7074
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-femzs0kd[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-femzs0kd/logs[0m
[38;5;196m2025-03-26 01:16:56,233 |         __main__ |    ERROR | [Rank 0]: Ranks 3 failed to pass monitoredBarrier in 60000 ms
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103657579
#9 c10d::ProcessGroupGloo::monitoredBarrier(c10d::BarrierOptions const&, bool) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103682775
#10 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#11 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#19 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#23 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#24 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#26 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#27 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#34 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#35 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#36 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#37 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#38 __libc_start_main from /lib64/libc.so.6:241028
#39 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: [Rank 0]: Ranks 3 failed to pass monitoredBarrier in 60000 ms
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103657579
#9 c10d::ProcessGroupGloo::monitoredBarrier(c10d::BarrierOptions const&, bool) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103682775
#10 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#11 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#19 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#23 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#24 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#26 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#27 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#34 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#35 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#36 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#37 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#38 __libc_start_main from /lib64/libc.so.6:241028
#39 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-wucuuz96[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-wucuuz96/logs[0m
[38;5;196m2025-03-26 01:16:56,410 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.4.0.4]:8110
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.4.0.4]:8110
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-1pb1fi5d[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-1pb1fi5d/logs[0m
[38;5;196m2025-03-26 01:16:56,420 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.4.0.4]:8110
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.4.0.4]:8110
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-s6abzh8b[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-s6abzh8b/logs[0m
[38;5;196m2025-03-26 01:16:56,412 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.2]:24488
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.2]:24488
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:56,412 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.2]:2991
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.2]:2991
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:56,413 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.2]:9112
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.2]:9112
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-p6627g6k[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-p6627g6k/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-4gzqi1xw[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-4gzqi1xw/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-42dye94v[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-42dye94v/logs[0m
[38;5;196m2025-03-26 01:16:56,422 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.2]:21410
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.2]:21410
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:56,422 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.2]:2991
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.2]:2991
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:56,422 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.2]:24488
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.2]:24488
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[38;5;196m2025-03-26 01:16:56,423 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.2]:9112
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.2]:9112
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-3zjozlyd[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-3zjozlyd/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-j3jx71fw[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-j3jx71fw/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-9krcsf8a[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-9krcsf8a/logs[0m
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-gpemkq16[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-gpemkq16/logs[0m
[38;5;196m2025-03-26 01:16:56,432 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.2]:21410
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.2]:21410
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-nzcibct2[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-nzcibct2/logs[0m
[38;5;196m2025-03-26 01:16:56,440 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.181]:61322
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.181]:61322
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-27tp8r8b[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-27tp8r8b/logs[0m
[38;5;196m2025-03-26 01:16:56,450 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.181]:61322
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.3.0.181]:61322
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-z0qbwo6b[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-z0qbwo6b/logs[0m
[38;5;196m2025-03-26 01:16:56,543 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.182]:12208
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.182]:12208
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-f169qxly[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-f169qxly/logs[0m
[38;5;196m2025-03-26 01:16:56,554 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.182]:12208
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.182]:12208
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011640-u3wfwnxv[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011640-u3wfwnxv/logs[0m
[38;5;196m2025-03-26 01:16:56,788 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.211]:43183
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 629, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.211]:43183
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-5u3cohwp[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-5u3cohwp/logs[0m
[38;5;196m2025-03-26 01:16:57,098 |         __main__ |    ERROR | [Rank 0]: Ranks 3 failed to pass monitoredBarrier in 60000 ms
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103657579
#9 c10d::ProcessGroupGloo::monitoredBarrier(c10d::BarrierOptions const&, bool) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103682775
#10 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#11 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#19 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#23 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#24 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#26 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#27 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#34 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#35 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#36 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#37 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#38 __libc_start_main from /lib64/libc.so.6:241028
#39 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: [Rank 0]: Ranks 3 failed to pass monitoredBarrier in 60000 ms
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103657579
#9 c10d::ProcessGroupGloo::monitoredBarrier(c10d::BarrierOptions const&, bool) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103682775
#10 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#11 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#18 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#19 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#21 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#22 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#23 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#24 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#25 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#26 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#27 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#29 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#30 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#31 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#32 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#33 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#34 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#35 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#36 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#37 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#38 __libc_start_main from /lib64/libc.so.6:241028
#39 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-xlh3hpnq[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-xlh3hpnq/logs[0m
[38;5;196m2025-03-26 01:16:57,408 |         __main__ |    ERROR | Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.182]:6064
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 1 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.182]:6064
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-m1mvxlsv[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-m1mvxlsv/logs[0m
[38;5;196m2025-03-26 01:16:57,418 |         __main__ |    ERROR | Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.182]:6064
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269
[0m
Traceback (most recent call last):
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 251, in main
    pretraining(
  File "/leonardo_scratch/fast/uToID_bench/xffl/examples/llm/client/src/training.py", line 112, in pretraining
    model: FullyShardedDataParallel = modelling.create_fsdp_model(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/xffl/learning/modelling.py", line 60, in create_fsdp_model
    model: FullyShardedDataParallel = FullyShardedDataParallel(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 509, in __init__
    _init_param_handle_from_module(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 633, in _init_param_handle_from_module
    _sync_module_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py", line 1126, in _sync_module_params_and_buffers
    _sync_params_and_buffers(
  File "/leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/distributed/utils.py", line 334, in _sync_params_and_buffers
    dist._broadcast_coalesced(
RuntimeError: Rank 2 successfully reached monitoredBarrier, but received errors while waiting for send/recv from rank 0. Please check rank 0 logs for faulty rank.
 Original exception: 
[/pytorch/third_party/gloo/gloo/transport/tcp/pair.cc:534] Connection closed by peer [10.2.0.182]:6064
Exception raised from logAndThrow at /pytorch/torch/csrc/distributed/c10d/ProcessGroupGloo.cpp:146 (most recent call first):
C++ CapturedTraceback:
#4 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:574781
#5 c10::Error::Error(c10::SourceLocation, std::string) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:582069
#6 c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libc10.so:227957
#7 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103645421
#8 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:23096071
#9 c10d::ProcessGroupWrapper::runCollectiveChecks(c10d::OpType, std::vector<at::Tensor, std::allocator<at::Tensor> > const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103834109
#10 c10d::ProcessGroupWrapper::broadcast(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::BroadcastOptions const&) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103836640
#11 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103486389
#12 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103533861
#13 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93045370
#14 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:93035256
#15 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:28092919
#16 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103560089
#17 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103627567
#18 c10d::broadcast_coalesced(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, c10::ArrayRef<at::Tensor>, unsigned long, int) from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so:103963987
#19 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:14967805
#20 ?? from /leonardo_scratch/fast/uToID_bench/xffl/.venv/lib/python3.11/site-packages/torch/lib/libtorch_python.so:5349398
#21 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1740594
#22 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#23 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#24 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444479
#25 _PyObject_FastCallDictTstate from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407656
#26 _PyObject_Call_Prepend from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1408259
#27 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1878883
#28 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1849212
#29 _PyObject_MakeTpCall from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1407196
#30 _PyEval_EvalFrameDefault from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:1037563
#31 PyEval_EvalCode from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2444132
#32 ?? from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2736355
#33 _PyRun_SimpleFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2742292
#34 _PyRun_AnyFileObject from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2743755
#35 Py_RunMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2870431
#36 Py_BytesMain from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/lib/libpython3.11.so.1.0:2871714
#37 __libc_start_main from /lib64/libc.so.6:241028
#38 _start from /leonardo/prod/spack/5.2/install/0.21/linux-rhel8-icelake/gcc-8.5.0/python-3.11.6-i5k3c6ggftqkzgqyymfbkynpgm2lgjtd/bin/python3.11:4198269

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /leonardo/home/userexternal/gmittone/wandb/offline-run-20250326_011642-xbf9nqzo[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250326_011642-xbf9nqzo/logs[0m
[38;20m2025-03-26 01:16:59,534 | xffl.cli.simulate |     INFO | Total simulation execution time: 35.36 seconds[0m
[38;20m2025-03-26 01:16:59,535 | xffl.cli.simulate |     INFO | *** Cross-Facility Federated Learning (xFFL) - Simulation ***[0m
